<!DOCTYPE HTML>
<html>
<head >
  <meta charset="utf-8">
  
  <title>[Mysql] mysql-mgr模拟the master has purged binary logs containing GTIDs that the slave requires.&#39;, Error_code: 1236 | zeven&#39;s blog</title>

  
  <meta name="author" content="zeven0707&#39;s blog">
  

  
  <meta name="description" content="0、实验环境介绍：mysql-mgr单主模式主节点1、从节点1、从节点2
1、实验一，手动删除主库binlog日志文件从库21执行stop group_replication;
主库：1234567891011121314#切换日志，创建表gtid_test10,并查看当前的binlog日志文件：f">
  

  
  
  <meta name="keywords" content="mysql">
  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <meta property="og:title" content="[Mysql] mysql-mgr模拟the master has purged binary logs containing GTIDs that the slave requires.&#39;, Error_code: 1236"/>

  <meta property="og:site_name" content="zeven&#39;s blog"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  
  
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-5005349780815724",
    enable_page_level_ads: true
  });
</script>

  
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?223eea22355699157e147870eb124b24";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>


  <link rel="manifest" href="/manifest.json">
  <link href="/favicon.ico" rel="icon">

  <link rel="alternate" href="/atom.xml" title="zeven&#39;s blog" type="application/atom+xml">
  <link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/base/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">


</head>


<body>
<div class="blog">
  <div class="content">

    

    <header class="header-container" style="background-image: url('/images/blog-bg.jpg');">


<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <div class="navbar-header page-scroll">
          <button type="button" id="tglBtn" class="navbar-toggle">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">zeven0707&#39;s blog</a>
        </div>
        <div id="bosenyblog-navbar">
          <div class="navbar-collapse" id="bs-example-navbar-collapse-6">
            <ul class="nav navbar-nav navbar-right">
            
              <li><a href="/">主页</a></li>
            
              <li><a href="/archives">日志</a></li>
            
              <li><a href="/about">关于</a></li>
            
              <li><a href="/tags">标签</a></li>
            
            </ul>
          </div>
        </div>

    </div>
 </nav>
 <div class="gotop-btn">

 </div>
</header>

        
          <div class="container ">
          <div class="row">
            <main class="site-main posts-loop col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container" style="position: inherit;">
            <article class="article-container ">

  
    
    <h3 class="article-title"><span>[Mysql] mysql-mgr模拟the master has purged binary logs containing GTIDs that the slave requires.&#39;, Error_code: 1236</span></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2018/11/25/mysql-mgr模拟the master has purged binary logs containing GTIDs that the slave requires/" rel="bookmark">
        <time class="entry-date published" datetime="2018-11-25T14:51:00.000Z">
          2018-11-25
        </time>
      </a>
    </span>
    <br />
    
    <span id="busuanzi_container_page_pv">
      本文总阅读量<span id="busuanzi_value_page_pv"></span>次
    </span>
    
  </div>


  

  <div class="article-content">
    <div class="entry">
      
          <h4 id="0、实验环境介绍："><a href="#0、实验环境介绍：" class="headerlink" title="0、实验环境介绍："></a>0、实验环境介绍：</h4><p>mysql-mgr单主模式主节点1、从节点1、从节点2</p>
<h4 id="1、实验一，手动删除主库binlog日志文件"><a href="#1、实验一，手动删除主库binlog日志文件" class="headerlink" title="1、实验一，手动删除主库binlog日志文件"></a>1、实验一，手动删除主库binlog日志文件</h4><p>从库2<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">执行stop group_replication;</span><br></pre></td></tr></table></figure></p>
<p>主库：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#切换日志，创建表gtid_test10,并查看当前的binlog日志文件：</span><br><span class="line">flush logs;create table gtid_test10 (ID int) engine=innodb;</span><br><span class="line">Query OK, 0 rows affected (0.04 sec)</span><br><span class="line">Query OK, 0 rows affected (0.05 sec)</span><br><span class="line">root@db 05:48:  [test]&gt; show master status;</span><br><span class="line">+---------------------+----------+--------------+------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| File                | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set                                                                                                                                                         |</span><br><span class="line">+---------------------+----------+--------------+------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| mysql-binlog.000029 |      493 |              |                  | 8182e5ae-af54-11e8-af0e-000d3a801ae2:1-13253,</span><br><span class="line">c42e3372-ba21-11e8-99ed-000d3a800ed3:1-2,</span><br><span class="line">d240752c-b809-11e8-8947-000d3a800ed3:1,</span><br><span class="line">dd412cc2-ba1f-11e8-9ba2-000d3a801ae2:1-27 |</span><br><span class="line">+---------------------+----------+--------------+------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure></p>
<p>#切换日志，创建表gtid_test10,并查看当前的binlog日志文件：<br>root@db 05:48:  [test]&gt; flush logs;create table gtid_test11 (ID int) engine=innodb;<br>Query OK, 0 rows affected (0.05 sec)</p>
<p>Query OK, 0 rows affected (0.05 sec)</p>
<p>root@db 05:48:  [test]&gt; show master status;<br>+———————+———-+————–+——————+—————————————————————————————————————————————————————————+<br>| File                | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set                                                                                                                                                         |<br>+———————+———-+————–+——————+—————————————————————————————————————————————————————————+<br>| mysql-binlog.000030 |      493 |              |                  | 8182e5ae-af54-11e8-af0e-000d3a801ae2:1-13253,<br>c42e3372-ba21-11e8-99ed-000d3a800ed3:1-2,<br>d240752c-b809-11e8-8947-000d3a800ed3:1,<br>dd412cc2-ba1f-11e8-9ba2-000d3a801ae2:1-28 |<br>+———————+———-+————–+——————+—————————————————————————————————————————————————————————+</p>
<p>#主库手动移除binlog文件：<br>mv mysql-binlog.000029 /tmp/<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">从库2</span><br></pre></td></tr></table></figure></p>
<p>执行start group_replication;</p>
<p>#查看从库2的日志<br>2018-09-18T05:49:55.983888Z 93 [Note] Plugin group_replication reported: ‘Establishing group recovery connection with a possible donor. Attempt 1/10’<br>2018-09-18T05:49:55.984034Z 0 [Note] Plugin group_replication reported: ‘Group membership changed to dax-mysql-slave:3306, dax-mysql-master:3306, dax-mysql-slave2:3306 on view 15371510730966421:31.’<br>2018-09-18T05:49:56.054981Z 93 [Note] ‘CHANGE MASTER TO FOR CHANNEL ‘group_replication_recovery’ executed’. Previous state master_host=’<null>‘, master_port= 0, master_log_file=’’, master_log_pos= 4, master_bind=’’. New state master_host=’dax-mysql-master’, master_port= 3306, master_log_file=’’, master_log_pos= 4, master_bind=’’.<br>2018-09-18T05:49:56.144944Z 93 [Note] Plugin group_replication reported: ‘Establishing connection to a group replication recovery donor 8182e5ae-af54-11e8-af0e-000d3a801ae2 at dax-mysql-master port: 3306.’<br>2018-09-18T05:49:56.155058Z 95 [Warning] Storing MySQL user name or password information in the master info repository is not secure and is therefore not recommended. Please consider using the USER and PASSWORD connection options for START SLAVE; see the ‘START SLAVE Syntax’ in the MySQL Manual for more information.<br>2018-09-18T05:49:56.157141Z 95 [Note] Slave I/O thread for channel ‘group_replication_recovery’: connected to master ‘repl@dax-mysql-master:3306’,replication started in log ‘FIRST’ at position 4<br>2018-09-18T05:49:56.179441Z 96 [Note] Slave SQL thread for channel ‘group_replication_recovery’ initialized, starting replication in log ‘FIRST’ at position 0, relay log ‘./relay-log-group_replication_recovery.000001’ position: 4<br>2018-09-18T05:49:56.326072Z 95 [ERROR] Error reading packet from server for channel ‘group_replication_recovery’: Could not open log file (server_errno=1236)<br>2018-09-18T05:49:56.326236Z 95 [ERROR] Slave I/O for channel ‘group_replication_recovery’: Got fatal error 1236 from master when reading data from binary log: ‘Could not open log file’, Error_code: 1236</null></p>
<p>#因为已经手动删除了binlog文件，从库2无法从主库获取到binlog文件，报错<br>2018-09-18T05:49:56.326310Z 95 [Note] Slave I/O thread exiting for channel ‘group_replication_recovery’, read up to log ‘mysql-binlog.000029’, position 4<br>2018-09-18T05:49:56.326422Z 93 [Note] Plugin group_replication reported: ‘Terminating existing group replication donor connection and purging the corresponding logs.’<br>2018-09-18T05:49:56.347776Z 96 [Note] Error reading relay log event for channel ‘group_replication_recovery’: slave SQL thread was killed<br>2018-09-18T05:49:56.438760Z 93 [Note] ‘CHANGE MASTER TO FOR CHANNEL ‘group_replication_recovery’ executed’. Previous state master_host=’dax-mysql-master’, master_port= 3306, master_log_file=’’, master_log_pos= 4, master_bind=’’. New state master_host=’<null>‘, master_port= 0, master_log_file=’’, master_log_pos= 4, master_bind=’’.<br>2018-09-18T05:49:56.510091Z 93 [Note] Plugin group_replication reported: ‘Retrying group recovery connection with another donor. Attempt 2/10’<br>2018-09-18T05:49:56.572561Z 93 [Note] ‘CHANGE MASTER TO FOR CHANNEL ‘group_replication_recovery’ executed’. Previous state master_host=’<null>‘, master_port= 0, master_log_file=’’, master_log_pos= 4, master_bind=’’. New state master_host=’dax-mysql-slave’, master_port= 3306, master_log_file=’’, master_log_pos= 4, master_bind=’’.</null></null></p>
<p>#从库2开始尝试从从库1节点获取binlog文件，因为只是删除了主库节点的binlog文件，从库1的文件未删除，从库2获取到所需要的文件，开始进行同步。<br>2018-09-18T05:49:56.643413Z 93 [Note] Plugin group_replication reported: ‘Establishing connection to a group replication recovery donor 66d67181-ba5b-11e8-9c54-000d3a800ed3 at dax-mysql-slave port: 3306.’<br>2018-09-18T05:49:56.643906Z 99 [Warning] Storing MySQL user name or password information in the master info repository is not secure and is therefore not recommended. Please consider using the USER and PASSWORD connection options for START SLAVE; see the ‘START SLAVE Syntax’ in the MySQL Manual for more information.<br>2018-09-18T05:49:56.646363Z 99 [Note] Slave I/O thread for channel ‘group_replication_recovery’: connected to master ‘repl@dax-mysql-slave:3306’,replication started in log ‘FIRST’ at position 4<br>2018-09-18T05:49:56.666439Z 100 [Note] Slave SQL thread for channel ‘group_replication_recovery’ initialized, starting replication in log ‘FIRST’ at position 0, relay log ‘./relay-log-group_replication_recovery.000001’ position: 4<br>2018-09-18T05:49:56.882987Z 93 [Note] Plugin group_replication reported: ‘Terminating existing group replication donor connection and purging the corresponding logs.’<br>2018-09-18T05:49:56.905507Z 99 [Note] Slave I/O thread killed while reading event for channel ‘group_replication_recovery’<br>2018-09-18T05:49:56.905535Z 99 [Note] Slave I/O thread exiting for channel ‘group_replication_recovery’, read up to log ‘mysql-binlog.000005’, position 10512<br>2018-09-18T05:49:56.999936Z 93 [Note] ‘CHANGE MASTER TO FOR CHANNEL ‘group_replication_recovery’ executed’. Previous state master_host=’dax-mysql-slave’, master_port= 3306, master_log_file=’’, master_log_pos= 4, master_bind=’’. New state master_host=’<null>‘, master_port= 0, master_log_file=’’, master_log_pos= 4, master_bind=’’.<br>2018-09-18T05:49:57.084035Z 0 [Note] Plugin group_replication reported: ‘This server was declared online within the replication group’<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">同步完成。</span><br><span class="line"></span><br><span class="line">#### 2、实验二，使用purge命令删除主库binlog文件</span><br><span class="line">从库2</span><br></pre></td></tr></table></figure></null></p>
<p>stop group_replication:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">主库1</span><br></pre></td></tr></table></figure></p>
<p>#切换日志，创建表gtid_test12,并查看当前的binlog日志文件：<br>root@db 06:04:  [test]&gt; flush logs;create table gtid_test12 (ID int) engine=innodb;<br>Query OK, 0 rows affected (0.03 sec)<br>Query OK, 0 rows affected (0.05 sec)<br>root@db 06:04:  [test]&gt; show master status;<br>+———————+———-+————–+——————+—————————————————————————————————————————————————————————+<br>| File                | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set                                                                                                                                                         |<br>+———————+———-+————–+——————+—————————————————————————————————————————————————————————+<br>| mysql-binlog.000033 |      493 |              |                  | 8182e5ae-af54-11e8-af0e-000d3a801ae2:1-13253,<br>c42e3372-ba21-11e8-99ed-000d3a800ed3:1-2,<br>d240752c-b809-11e8-8947-000d3a800ed3:1,<br>dd412cc2-ba1f-11e8-9ba2-000d3a801ae2:1-30 |<br>+———————+———-+————–+——————+—————————————————————————————————————————————————————————+<br>1 row in set (0.00 sec)</p>
<p>#切换日志，创建表gtid_test13,并查看当前的binlog日志文件：<br>root@db 06:04:  [test]&gt; flush logs;create table gtid_test13 (ID int) engine=innodb;<br>Query OK, 0 rows affected (0.04 sec)<br>Query OK, 0 rows affected (0.05 sec)<br>root@db 06:04:  [test]&gt; show master status;<br>+———————+———-+————–+——————+—————————————————————————————————————————————————————————+<br>| File                | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set                                                                                                                                                         |<br>+———————+———-+————–+——————+—————————————————————————————————————————————————————————+<br>| mysql-binlog.000034 |      493 |              |                  | 8182e5ae-af54-11e8-af0e-000d3a801ae2:1-13253,<br>c42e3372-ba21-11e8-99ed-000d3a800ed3:1-2,<br>d240752c-b809-11e8-8947-000d3a800ed3:1,<br>dd412cc2-ba1f-11e8-9ba2-000d3a801ae2:1-31 |<br>+———————+———-+————–+——————+—————————————————————————————————————————————————————————+</p>
<p>#主库清除mysql-binlog.000034之前的所有binlog日志：<br>purge binary logs to ‘mysql-binlog.000034’;</p>
<p>#查看日志log目录下的34之前的日志已经全部清除：<br>ll mysql-binlog.*<br>-rw-r—– 1 mysql mysql 493 Sep 18 06:04 mysql-binlog.000034<br>-rw-r—– 1 mysql mysql  36 Sep 18 06:22 mysql-binlog.index</p>
<p>#查看主库gtid信息，gtid_purged已经有记录：<br>show global variables like ‘%gtid%’;<br>root@db 06:37:  [test]&gt; show global variables like ‘%gtid%’;<br>+—————————————————+—————————————————————————————————————————————————————————+<br>| Variable_name                                     | Value                                                                                                                                                                     |<br>+—————————————————+—————————————————————————————————————————————————————————+<br>| binlog_gtid_simple_recovery                       | ON                                                                                                                                                                        |<br>| enforce_gtid_consistency                          | ON                                                                                                                                                                        |<br>| group_replication_allow_local_disjoint_gtids_join | ON                                                                                                                                                                        |<br>| group_replication_gtid_assignment_block_size      | 1000000                                                                                                                                                                   |<br>| gtid_executed                                     | 8182e5ae-af54-11e8-af0e-000d3a801ae2:1-13253,<br>c42e3372-ba21-11e8-99ed-000d3a800ed3:1-2,<br>d240752c-b809-11e8-8947-000d3a800ed3:1,<br>dd412cc2-ba1f-11e8-9ba2-000d3a801ae2:1-31 |<br>| gtid_executed_compression_period                  | 1000                                                                                                                                                                      |<br>| gtid_mode                                         | ON                                                                                                                                                                        |<br>| gtid_owned                                        |                                                                                                                                                                           |<br>| gtid_purged                                       | 8182e5ae-af54-11e8-af0e-000d3a801ae2:1-13253,<br>c42e3372-ba21-11e8-99ed-000d3a800ed3:1-2,<br>d240752c-b809-11e8-8947-000d3a800ed3:1,<br>dd412cc2-ba1f-11e8-9ba2-000d3a801ae2:1-30 |<br>| session_track_gtids                               | OFF                                                                                                                                                                       |<br>+—————————————————+—————————————————————————————————————————————————————————+<br>10 rows in set (0.01 sec)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">从节点2</span><br></pre></td></tr></table></figure></p>
<p>start group_replication;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">查看从库2的日志</span><br></pre></td></tr></table></figure></p>
<p>2018-09-18T06:38:36.664372Z 107 [Note] Plugin group_replication reported: ‘Initialized group communication with configuration: group_replication_group_name: “dd412cc2-ba1f-11e8-9ba2-000d3a801ae2”; group_replication_local_address: “dax-mysql-slave2:24901”; group_replication_group_seeds: “dax-mysql-slave:24901,dax-mysql-master:24901,dax-mysql-slave2:24901”; group_replication_bootstrap_group: false; group_replication_poll_spin_loops: 0; group_replication_compression_threshold: 1000000; group_replication_ip_whitelist: “AUTOMATIC”‘<br>2018-09-18T06:38:36.664408Z 107 [Note] Plugin group_replication reported: ‘[GCS] Configured number of attempts to join: 0’<br>2018-09-18T06:38:36.664428Z 107 [Note] Plugin group_replication reported: ‘[GCS] Configured time between attempts to join: 5 seconds’<br>2018-09-18T06:38:36.664457Z 107 [Note] Plugin group_replication reported: ‘Member configuration: member_id: 3306101; member_uuid: “c6ac9ccd-b80b-11e8-b968-000d3a801bf4”; single-primary mode: “true”; group_replication_auto_increment_increment: 1; ‘<br>2018-09-18T06:38:36.664812Z 109 [Note] ‘CHANGE MASTER TO FOR CHANNEL ‘group_replication_applier’ executed’. Previous state master_host=’<null>‘, master_port= 0, master_log_file=’’, master_log_pos= 493, master_bind=’’. New state master_host=’<null>‘, master_port= 0, master_log_file=’’, master_log_pos= 4, master_bind=’’.<br>2018-09-18T06:38:36.736702Z 107 [Note] Plugin group_replication reported: ‘Group Replication applier module successfully initialized!’<br>2018-09-18T06:38:36.736749Z 107 [Note] Plugin group_replication reported: ‘auto_increment_increment is set to 1’<br>2018-09-18T06:38:36.736774Z 107 [Note] Plugin group_replication reported: ‘auto_increment_offset is set to 3306101’<br>2018-09-18T06:38:36.736708Z 112 [Note] Slave SQL thread for channel ‘group_replication_applier’ initialized, starting replication in log ‘FIRST’ at position 0, relay log ‘./relay-log-group_replication_applier.000014’ position: 4<br>2018-09-18T06:38:36.737167Z 0 [Note] Plugin group_replication reported: ‘XCom protocol version: 3’<br>2018-09-18T06:38:36.737227Z 0 [Note] Plugin group_replication reported: ‘XCom initialized and ready to accept incoming connections on port 24901’<br>2018-09-18T06:38:38.815550Z 107 [Note] Plugin group_replication reported: ‘This server is working as secondary member with primary member address dax-mysql-master:3306.’<br>2018-09-18T06:38:38.815711Z 0 [ERROR] Plugin group_replication reported: ‘Group contains 3 members which is greater than group_replication_auto_increment_increment value of 1. This can lead to an higher rate of transactional aborts.’<br>2018-09-18T06:38:38.816035Z 117 [Note] Plugin group_replication reported: ‘Establishing group recovery connection with a possible donor. Attempt 1/10’<br>2018-09-18T06:38:38.816125Z 0 [Note] Plugin group_replication reported: ‘Group membership changed to dax-mysql-slave:3306, dax-mysql-master:3306, dax-mysql-slave2:3306 on view 15371510730966421:33.’<br>2018-09-18T06:38:38.881138Z 117 [Note] ‘CHANGE MASTER TO FOR CHANNEL ‘group_replication_recovery’ executed’. Previous state master_host=’<null>‘, master_port= 0, master_log_file=’’, master_log_pos= 4, master_bind=’’. New state master_host=’dax-mysql-slave’, master_port= 3306, master_log_file=’’, master_log_pos= 4, master_bind=’’.</null></null></null></p>
<p>#从节点2选择从从节点1获取binlog文件，因为从节点1文件没有删除，获取binlog文件正常。<br>2018-09-18T06:38:38.959786Z 117 [Note] Plugin group_replication reported: ‘Establishing connection to a group replication recovery donor 66d67181-ba5b-11e8-9c54-000d3a800ed3 at dax-mysql-slave port: 3306.’<br>2018-09-18T06:38:38.960147Z 119 [Warning] Storing MySQL user name or password information in the master info repository is not secure and is therefore not recommended. Please consider using the USER and PASSWORD connection options for START SLAVE; see the ‘START SLAVE Syntax’ in the MySQL Manual for more information.<br>2018-09-18T06:38:38.962244Z 119 [Note] Slave I/O thread for channel ‘group_replication_recovery’: connected to master ‘repl@dax-mysql-slave:3306’,replication started in log ‘FIRST’ at position 4<br>2018-09-18T06:38:38.982193Z 120 [Note] Slave SQL thread for channel ‘group_replication_recovery’ initialized, starting replication in log ‘FIRST’ at position 0, relay log ‘./relay-log-group_replication_recovery.000001’ position: 4<br>2018-09-18T06:38:39.194864Z 117 [Note] Plugin group_replication reported: ‘Terminating existing group replication donor connection and purging the corresponding logs.’<br>2018-09-18T06:38:39.218168Z 119 [Note] Slave I/O thread killed while reading event for channel ‘group_replication_recovery’<br>2018-09-18T06:38:39.218197Z 119 [Note] Slave I/O thread exiting for channel ‘group_replication_recovery’, read up to log ‘mysql-binlog.000005’, position 11362<br>2018-09-18T06:38:39.313623Z 117 [Note] ‘CHANGE MASTER TO FOR CHANNEL ‘group_replication_recovery’ executed’. Previous state master_host=’dax-mysql-slave’, master_port= 3306, master_log_file=’’, master_log_pos= 4, master_bind=’’. New state master_host=’<null>‘, master_port= 0, master_log_file=’’, master_log_pos= 4, master_bind=’’.<br>2018-09-18T06:38:39.400236Z 0 [Note] Plugin group_replication reported: ‘This server was declared online within the replication group’<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">同步完成。</span><br><span class="line"></span><br><span class="line">#### 3、实验三，删除主库节点和从节点1的binlog文件。</span><br><span class="line">从库2</span><br></pre></td></tr></table></figure></null></p>
<p>stop group_replication;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">主库1：</span><br></pre></td></tr></table></figure></p>
<p>3切换日志，创建表gtid_test14,并查看当前的binlog日志文件：<br>flush logs;create table gtid_test14 (ID int) engine=innodb;<br>show master status;</p>
<p>#切换日志，创建表gtid_test15,并查看当前的binlog日志文件：<br>flush logs;create table gtid_test15 (ID int) engine=innodb;<br>show master status;</p>
<p>#清除mysql-binlog.000036之前的日志：<br>purge binary logs to ‘mysql-binlog.000036’;<br>[root@dax-mysql-master log]# ll mysql-binlog.*<br>-rw-r—– 1 mysql mysql 493 Sep 18 06:53 mysql-binlog.000036<br>-rw-r—– 1 mysql mysql  36 Sep 18 06:56 mysql-binlog.index<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">从库1删除binlog日志：</span><br></pre></td></tr></table></figure></p>
<p>show master status;<br>+———————+———-+————–+——————+——————————————————————————————————————————————————————————————————————-+<br>| File                | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set                                                                                                                                                                                                 |<br>+———————+———-+————–+——————+——————————————————————————————————————————————————————————————————————-+<br>| mysql-binlog.000005 |    11728 |              |                  | 324a6fd1-ba55-11e8-b3ff-000d3a800ed3:1,<br>8182e5ae-af54-11e8-af0e-000d3a801ae2:1-13253,<br>c42e3372-ba21-11e8-99ed-000d3a800ed3:1-2,<br>d240752c-b809-11e8-8947-000d3a800ed3:1,<br>dd412cc2-ba1f-11e8-9ba2-000d3a801ae2:1-34 |<br>+———————+———-+————–+——————+——————————————————————————————————————————————————————————————————————-+</p>
<p>#切换binlog日志：<br>flush logs;<br>show master status;<br>root@db 06:57:  [test]&gt; show master status;<br>+———————+———-+————–+——————+——————————————————————————————————————————————————————————————————————-+<br>| File                | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set                                                                                                                                                                                                 |<br>+———————+———-+————–+——————+——————————————————————————————————————————————————————————————————————-+<br>| mysql-binlog.000006 |      350 |              |                  | 324a6fd1-ba55-11e8-b3ff-000d3a800ed3:1,<br>8182e5ae-af54-11e8-af0e-000d3a801ae2:1-13253,<br>c42e3372-ba21-11e8-99ed-000d3a800ed3:1-2,<br>d240752c-b809-11e8-8947-000d3a800ed3:1,<br>dd412cc2-ba1f-11e8-9ba2-000d3a801ae2:1-34 |<br>+———————+———-+————–+——————+——————————————————————————————————————————————————————————————————————-+<br>[root@dax-mysql-slave log]# ll<br>total 96<br>-rw-r—– 1 mysql mysql 53478 Sep 18 06:49 error.log<br>-rw-r—– 1 mysql mysql   177 Sep 17 08:39 mysql-binlog.000001<br>-rw-r—– 1 mysql mysql   437 Sep 17 09:21 mysql-binlog.000002<br>-rw-r—– 1 mysql mysql   217 Sep 17 09:25 mysql-binlog.000003<br>-rw-r—– 1 mysql mysql   209 Sep 17 09:26 mysql-binlog.000004<br>-rw-r—– 1 mysql mysql 11774 Sep 18 06:57 mysql-binlog.000005<br>-rw-r—– 1 mysql mysql   350 Sep 18 06:57 mysql-binlog.000006<br>-rw-r—– 1 mysql mysql   216 Sep 18 06:57 mysql-binlog.index<br>-rw-r–r– 1 mysql mysql     0 Sep 17 08:36 mysqld.log<br>-rw-r—– 1 mysql mysql  1968 Sep 18 06:57 slow.log</p>
<p>#删除mysql-binlog.000006之前的所有日志：<br>purge binary logs to ‘mysql-binlog.000006’;<br>[root@dax-mysql-slave log]# ll<br>total 68<br>-rw-r—– 1 mysql mysql 53478 Sep 18 06:49 error.log<br>-rw-r—– 1 mysql mysql   350 Sep 18 06:57 mysql-binlog.000006<br>-rw-r—– 1 mysql mysql    36 Sep 18 06:58 mysql-binlog.index<br>-rw-r–r– 1 mysql mysql     0 Sep 17 08:36 mysqld.log<br>-rw-r—– 1 mysql mysql  1968 Sep 18 06:57 slow.log<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">从库2</span><br></pre></td></tr></table></figure></p>
<p>start group_replicatinon;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">查看从库2的日志</span><br></pre></td></tr></table></figure></p>
<p>2018-09-18T06:59:20.236425Z 136 [Note] Plugin group_replication reported: ‘Retrying group recovery connection with another donor. Attempt 2/10’<br>2018-09-18T06:59:20.309947Z 136 [Note] ‘CHANGE MASTER TO FOR CHANNEL ‘group_replication_recovery’ executed’. Previous state master_host=’<null>‘, master_port= 0, master_log_file=’’, master_log_pos= 4, master_bind=’’. New state master_host=’dax-mysql-slave’, master_port= 3306, master_log_file=’’, master_log_pos= 4, master_bind=’’.<br>2018-09-18T06:59:20.391623Z 136 [Note] Plugin group_replication reported: ‘Establishing connection to a group replication recovery donor 66d67181-ba5b-11e8-9c54-000d3a800ed3 at dax-mysql-slave port: 3306.’<br>2018-09-18T06:59:20.391891Z 142 [Warning] Storing MySQL user name or password information in the master info repository is not secure and is therefore not recommended. Please consider using the USER and PASSWORD connection options for START SLAVE; see the ‘START SLAVE Syntax’ in the MySQL Manual for more information.<br>2018-09-18T06:59:20.394226Z 142 [Note] Slave I/O thread for channel ‘group_replication_recovery’: connected to master ‘repl@dax-mysql-slave:3306’,replication started in log ‘FIRST’ at position 4<br>2018-09-18T06:59:20.416722Z 143 [Note] Slave SQL thread for channel ‘group_replication_recovery’ initialized, starting replication in log ‘FIRST’ at position 0, relay log ‘./relay-log-group_replication_recovery.000001’ position: 4<br>2018-09-18T06:59:20.424400Z 142 [ERROR] Error reading packet from server for channel ‘group_replication_recovery’: The slave is connecting using CHANGE MASTER TO MASTER_AUTO_POSITION = 1, but the master has purged binary logs containing GTIDs that the slave requires. (server_errno=1236)<br>2018-09-18T06:59:20.424467Z 142 [ERROR] Slave I/O for channel ‘group_replication_recovery’: Got fatal error 1236 from master when reading data from binary log: ‘The slave is connecting using CHANGE MASTER TO MASTER_AUTO_POSITION = 1, but the master has purged binary logs containing GTIDs that the slave requires.’, Error_code: 1236<br>2018-09-18T06:59:20.424488Z 142 [Note] Slave I/O thread exiting for channel ‘group_replication_recovery’, read up to log ‘FIRST’, position 4<br>2018-09-18T06:59:20.424640Z 136 [Note] Plugin group_replication reported: ‘Terminating existing group replication donor connection and purging the corresponding logs.’<br>2018-09-18T06:59:20.436806Z 143 [Note] Error reading relay log event for channel ‘group_replication_recovery’: slave SQL thread was killed<br>2018-09-18T06:59:20.522269Z 136 [Note] ‘CHANGE MASTER TO FOR CHANNEL ‘group_replication_recovery’ executed’. Previous state master_host=’dax-mysql-slave’, master_port= 3306, master_log_file=’’, master_log_pos= 4, master_bind=’’. New state master_host=’<null>‘, master_port= 0, master_log_file=’’, master_log_pos= 4, master_bind=’’.<br>2018-09-18T06:59:20.603837Z 136 [Note] Plugin group_replication reported: ‘Retrying group recovery connection with another donor. Attempt 3/10’<br>2018-09-18T07:00:20.679461Z 136 [Note] ‘CHANGE MASTER TO FOR CHANNEL ‘group_replication_recovery’ executed’. Previous state master_host=’<null>‘, master_port= 0, master_log_file=’’, master_log_pos= 4, master_bind=’’. New state master_host=’dax-mysql-slave’, master_port= 3306, master_log_file=’’, master_log_pos= 4, master_bind=’’.<br>2018-09-18T07:00:20.762021Z 136 [Note] Plugin group_replication reported: ‘Establishing connection to a group replication recovery donor 66d67181-ba5b-11e8-9c54-000d3a800ed3 at dax-mysql-slave port: 3306.’<br>2018-09-18T07:00:20.762368Z 146 [Warning] Storing MySQL user name or password information in the master info repository is not secure and is therefore not recommended. Please consider using the USER and PASSWORD connection options for START SLAVE; see the ‘START SLAVE Syntax’ in the MySQL Manual for more information.<br>2018-09-18T07:00:20.764842Z 146 [Note] Slave I/O thread for channel ‘group_replication_recovery’: connected to master ‘repl@dax-mysql-slave:3306’,replication started in log ‘FIRST’ at position 4<br>2018-09-18T07:00:20.787728Z 147 [Note] Slave SQL thread for channel ‘group_replication_recovery’ initialized, starting replication in log ‘FIRST’ at position 0, relay log ‘./relay-log-group_replication_recovery.000001’ position: 4<br>2018-09-18T07:00:20.794590Z 146 [ERROR] Error reading packet from server for channel ‘group_replication_recovery’: The slave is connecting using CHANGE MASTER TO MASTER_AUTO_POSITION = 1, but the master has purged binary logs containing GTIDs that the slave requires. (server_errno=1236)<br>2018-09-18T07:00:20.794623Z 146 [ERROR] Slave I/O for channel ‘group_replication_recovery’: Got fatal error 1236 from master when reading data from binary log: ‘The slave is connecting using CHANGE MASTER TO MASTER_AUTO_POSITION = 1, but the master has purged binary logs containing GTIDs that the slave requires.’, Error_code: 1236<br>2018-09-18T07:00:20.794635Z 146 [Note] Slave I/O thread exiting for channel ‘group_replication_recovery’, read up to log ‘FIRST’, position 4<br>2018-09-18T07:00:20.794786Z 136 [Note] Plugin group_replication reported: ‘Terminating existing group replication donor connection and purging the corresponding logs.’<br>2018-09-18T07:00:20.807977Z 147 [Note] Error reading relay log event for channel ‘group_replication_recovery’: slave SQL thread was killed<br>2018-09-18T07:00:20.895774Z 136 [Note] ‘CHANGE MASTER TO FOR CHANNEL ‘group_replication_recovery’ executed’. Previous state master_host=’dax-mysql-slave’, master_port= 3306, master_log_file=’’, master_log_pos= 4, master_bind=’’. New state master_host=’<null>‘, master_port= 0, master_log_file=’’, master_log_pos= 4, master_bind=’’.</null></null></null></null></p>
<p>#从库2多次尝试从从库1获取binlog日志，没有成功，切换master_host节点，尝试从主库获取binlog日志文件：<br>2018-09-18T07:00:20.980112Z 136 [Note] Plugin group_replication reported: ‘Retrying group recovery connection with another donor. Attempt 4/10’<br>2018-09-18T07:00:21.052930Z 136 [Note] ‘CHANGE MASTER TO FOR CHANNEL ‘group_replication_recovery’ executed’. Previous state master_host=’<null>‘, master_port= 0, master_log_file=’’, master_log_pos= 4, master_bind=’’. New state master_host=’dax-mysql-master’, master_port= 3306, master_log_file=’’, master_log_pos= 4, master_bind=’’.<br>2018-09-18T07:00:21.141126Z 136 [Note] Plugin group_replication reported: ‘Establishing connection to a group replication recovery donor 8182e5ae-af54-11e8-af0e-000d3a801ae2 at dax-mysql-master port: 3306.’<br>2018-09-18T07:00:21.141498Z 150 [Warning] Storing MySQL user name or password information in the master info repository is not secure and is therefore not recommended. Please consider using the USER and PASSWORD connection options for START SLAVE; see the ‘START SLAVE Syntax’ in the MySQL Manual for more information.<br>2018-09-18T07:00:21.143773Z 150 [Note] Slave I/O thread for channel ‘group_replication_recovery’: connected to master ‘repl@dax-mysql-master:3306’,replication started in log ‘FIRST’ at position 4<br>2018-09-18T07:00:21.166993Z 151 [Note] Slave SQL thread for channel ‘group_replication_recovery’ initialized, starting replication in log ‘FIRST’ at position 0, relay log ‘./relay-log-group_replication_recovery.000001’ position: 4<br>2018-09-18T07:00:21.171461Z 150 [ERROR] Error reading packet from server for channel ‘group_replication_recovery’: The slave is connecting using CHANGE MASTER TO MASTER_AUTO_POSITION = 1, but the master has purged binary logs containing GTIDs that the slave requires. (server_errno=1236)<br>2018-09-18T07:00:21.171518Z 150 [ERROR] Slave I/O for channel ‘group_replication_recovery’: Got fatal error 1236 from master when reading data from binary log: ‘The slave is connecting using CHANGE MASTER TO MASTER_AUTO_POSITION = 1, but the master has purged binary logs containing GTIDs that the slave requires.’, Error_code: 1236<br>2018-09-18T07:00:21.171528Z 150 [Note] Slave I/O thread exiting for channel ‘group_replication_recovery’, read up to log ‘FIRST’, position 4<br>2018-09-18T07:00:21.171645Z 136 [Note] Plugin group_replication reported: ‘Terminating existing group replication donor connection and purging the corresponding logs.’<br>2018-09-18T07:00:21.186565Z 151 [Note] Error reading relay log event for channel ‘group_replication_recovery’: slave SQL thread was killed<br>2018-09-18T07:00:21.271867Z 136 [Note] ‘CHANGE MASTER TO FOR CHANNEL ‘group_replication_recovery’ executed’. Previous state master_host=’dax-mysql-master’, master_port= 3306, master_log_file=’’, master_log_pos= 4, master_bind=’’. New state master_host=’<null>‘, master_port= 0, master_log_file=’’, master_log_pos= 4, master_bind=’’.<br>….<br>[ERROR] Slave I/O for channel ‘group_replication_recovery’: Got fatal error 1236 from master when reading data from binary log: ‘The slave is connecting using CHANGE MASTER TO MASTER_AUTO_POSITION = 1, but the master has purged binary logs containing GTIDs that the slave requires.’, Error_code: 1236<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">因为主库1和从库1的binlog文件都删除，从库2无法同步，最后退出集群。</span><br><span class="line"></span><br><span class="line">#### 4、查看主库清除的日志</span><br></pre></td></tr></table></figure></null></null></p>
<p> show global variables like ‘%gtid%’;<br>+—————————————————+—————————————————————————————————————————————————————————+<br>| Variable_name                                     | Value                                                                                                                                                                     |<br>+—————————————————+—————————————————————————————————————————————————————————+<br>| binlog_gtid_simple_recovery                       | ON                                                                                                                                                                        |<br>| enforce_gtid_consistency                          | ON                                                                                                                                                                        |<br>| group_replication_allow_local_disjoint_gtids_join | ON                                                                                                                                                                        |<br>| group_replication_gtid_assignment_block_size      | 1000000                                                                                                                                                                   |<br>| gtid_executed                                     | 8182e5ae-af54-11e8-af0e-000d3a801ae2:1-13253,<br>c42e3372-ba21-11e8-99ed-000d3a800ed3:1-2,<br>d240752c-b809-11e8-8947-000d3a800ed3:1,<br>dd412cc2-ba1f-11e8-9ba2-000d3a801ae2:1-35 |<br>| gtid_executed_compression_period                  | 1000                                                                                                                                                                      |<br>| gtid_mode                                         | ON                                                                                                                                                                        |<br>| gtid_owned                                        |                                                                                                                                                                           |<br>| gtid_purged                                       | 8182e5ae-af54-11e8-af0e-000d3a801ae2:1-13253,<br>c42e3372-ba21-11e8-99ed-000d3a800ed3:1-2,<br>d240752c-b809-11e8-8947-000d3a800ed3:1,<br>dd412cc2-ba1f-11e8-9ba2-000d3a801ae2:1-33 |<br>| session_track_gtids                               | OFF                                                                                                                                                                       |<br>+—————————————————+—————————————————————————————————————————————————————————+<br>10 rows in set (0.00 sec)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">从库2尝试过滤掉缺失的那部分日志，然后重新加入集群：</span><br></pre></td></tr></table></figure></p>
<p>stop group_replication;<br>reset master;<br>set global GTID_PURGED=”8182e5ae-af54-11e8-af0e-000d3a801ae2:1-13253,c42e3372-ba21-11e8-99ed-000d3a800ed3:1-2,d240752c-b809-11e8-8947-000d3a800ed3:1,dd412cc2-ba1f-11e8-9ba2-000d3a801ae2:1-33”;<br>start group_replication;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">再次查看从库2的日志</span><br></pre></td></tr></table></figure></p>
<p>2018-09-18T07:08:05.524626Z 125 [Note] @@GLOBAL.GTID_PURGED was changed from ‘’ to ‘8182e5ae-af54-11e8-af0e-000d3a801ae2:1-13253,<br>c42e3372-ba21-11e8-99ed-000d3a800ed3:1-2,<br>d240752c-b809-11e8-8947-000d3a800ed3:1,<br>dd412cc2-ba1f-11e8-9ba2-000d3a801ae2:1-33’.<br>2018-09-18T07:08:05.524661Z 125 [Note] @@GLOBAL.GTID_EXECUTED was changed from ‘’ to ‘8182e5ae-af54-11e8-af0e-000d3a801ae2:1-13253,<br>c42e3372-ba21-11e8-99ed-000d3a800ed3:1-2,<br>d240752c-b809-11e8-8947-000d3a800ed3:1,<br>dd412cc2-ba1f-11e8-9ba2-000d3a801ae2:1-33’.<br>2018-09-18T07:08:20.457841Z 125 [Note] Plugin group_replication reported: ‘Group communication SSL configuration: group_replication_ssl_mode: “DISABLED”‘<br>2018-09-18T07:08:20.457971Z 125 [Note] Plugin group_replication reported: ‘[GCS] Added automatically IP ranges 10.0.7.51/24,127.0.0.1/8 to the whitelist’<br>2018-09-18T07:08:20.458188Z 125 [Note] Plugin group_replication reported: ‘[GCS] Translated ‘dax-mysql-slave2’ to 10.0.7.51’<br>2018-09-18T07:08:20.458321Z 125 [Warning] Plugin group_replication reported: ‘[GCS] Automatically adding IPv4 localhost address to the whitelist. It is mandatory that it is added.’<br>2018-09-18T07:08:20.458401Z 125 [Note] Plugin group_replication reported: ‘[GCS] SSL was not enabled’<br>2018-09-18T07:08:20.458433Z 125 [Note] Plugin group_replication reported: ‘Initialized group communication with configuration: group_replication_group_name: “dd412cc2-ba1f-11e8-9ba2-000d3a801ae2”; group_replication_local_address: “dax-mysql-slave2:24901”; group_replication_group_seeds: “dax-mysql-slave:24901,dax-mysql-master:24901,dax-mysql-slave2:24901”; group_replication_bootstrap_group: false; group_replication_poll_spin_loops: 0; group_replication_compression_threshold: 1000000; group_replication_ip_whitelist: “AUTOMATIC”‘<br>2018-09-18T07:08:20.458473Z 125 [Note] Plugin group_replication reported: ‘[GCS] Configured number of attempts to join: 0’<br>2018-09-18T07:08:20.458480Z 125 [Note] Plugin group_replication reported: ‘[GCS] Configured time between attempts to join: 5 seconds’<br>2018-09-18T07:08:20.458503Z 125 [Note] Plugin group_replication reported: ‘Member configuration: member_id: 3306101; member_uuid: “c6ac9ccd-b80b-11e8-b968-000d3a801bf4”; single-primary mode: “true”; group_replication_auto_increment_increment: 1; ‘<br>2018-09-18T07:08:20.458664Z 181 [Note] Plugin group_replication reported: ‘Detected previous RESET MASTER invocation or an issue exists in the group replication applier relay log. Purging existing applier logs.’<br>2018-09-18T07:08:20.531810Z 181 [Note] ‘CHANGE MASTER TO FOR CHANNEL ‘group_replication_applier’ executed’. Previous state master_host=’’, master_port= 3306, master_log_file=’’, master_log_pos= 4, master_bind=’’. New state master_host=’<null>‘, master_port= 0, master_log_file=’’, master_log_pos= 4, master_bind=’’.<br>2018-09-18T07:08:20.632692Z 125 [Note] Plugin group_replication reported: ‘Group Replication applier module successfully initialized!’<br>2018-09-18T07:08:20.632736Z 125 [Note] Plugin group_replication reported: ‘auto_increment_increment is set to 1’<br>2018-09-18T07:08:20.632758Z 125 [Note] Plugin group_replication reported: ‘auto_increment_offset is set to 3306101’<br>2018-09-18T07:08:20.632694Z 184 [Note] Slave SQL thread for channel ‘group_replication_applier’ initialized, starting replication in log ‘FIRST’ at position 0, relay log ‘./relay-log-group_replication_applier.000001’ position: 4<br>2018-09-18T07:08:20.632947Z 0 [Note] Plugin group_replication reported: ‘XCom protocol version: 3’<br>2018-09-18T07:08:20.632977Z 0 [Note] Plugin group_replication reported: ‘XCom initialized and ready to accept incoming connections on port 24901’<br>2018-09-18T07:08:22.329812Z 125 [Note] Plugin group_replication reported: ‘This server is working as secondary member with primary member address dax-mysql-master:3306.’<br>2018-09-18T07:08:22.329901Z 0 [ERROR] Plugin group_replication reported: ‘Group contains 3 members which is greater than group_replication_auto_increment_increment value of 1. This can lead to an higher rate of transactional aborts.’<br>2018-09-18T07:08:22.330145Z 189 [Note] Plugin group_replication reported: ‘Establishing group recovery connection with a possible donor. Attempt 1/10’<br>2018-09-18T07:08:22.330221Z 0 [Note] Plugin group_replication reported: ‘Group membership changed to dax-mysql-slave:3306, dax-mysql-master:3306, dax-mysql-slave2:3306 on view 15371510730966421:37.’<br>2018-09-18T07:08:22.394512Z 189 [Note] ‘CHANGE MASTER TO FOR CHANNEL ‘group_replication_recovery’ executed’. Previous state master_host=’<null>‘, master_port= 0, master_log_file=’’, master_log_pos= 4, master_bind=’’. New state master_host=’dax-mysql-master’, master_port= 3306, master_log_file=’’, master_log_pos= 4, master_bind=’’.<br>2018-09-18T07:08:22.468142Z 189 [Note] Plugin group_replication reported: ‘Establishing connection to a group replication recovery donor 8182e5ae-af54-11e8-af0e-000d3a801ae2 at dax-mysql-master port: 3306.’<br>2018-09-18T07:08:22.468378Z 191 [Warning] Storing MySQL user name or password information in the master info repository is not secure and is therefore not recommended. Please consider using the USER and PASSWORD connection options for START SLAVE; see the ‘START SLAVE Syntax’ in the MySQL Manual for more information.<br>2018-09-18T07:08:22.470340Z 191 [Note] Slave I/O thread for channel ‘group_replication_recovery’: connected to master ‘repl@dax-mysql-master:3306’,replication started in log ‘FIRST’ at position 4<br>2018-09-18T07:08:22.490866Z 192 [Note] Slave SQL thread for channel ‘group_replication_recovery’ initialized, starting replication in log ‘FIRST’ at position 0, relay log ‘./relay-log-group_replication_recovery.000001’ position: 4<br>2018-09-18T07:08:22.632774Z 189 [Note] Plugin group_replication reported: ‘Terminating existing group replication donor connection and purging the corresponding logs.’<br>2018-09-18T07:08:22.653083Z 191 [Note] Slave I/O thread killed while reading event for channel ‘group_replication_recovery’<br>2018-09-18T07:08:22.653098Z 191 [Note] Slave I/O thread exiting for channel ‘group_replication_recovery’, read up to log ‘mysql-binlog.000036’, position 1381<br>2018-09-18T07:08:22.734186Z 189 [Note] ‘CHANGE MASTER TO FOR CHANNEL ‘group_replication_recovery’ executed’. Previous state master_host=’dax-mysql-master’, master_port= 3306, master_log_file=’’, master_log_pos= 4, master_bind=’’. New state master_host=’<null>‘, master_port= 0, master_log_file=’’, master_log_pos= 4, master_bind=’’.<br>2018-09-18T07:08:22.808784Z 0 [Note] Plugin group_replication reported: ‘This server was declared online within the replication group’<br><code>`</code><br>此时从库2与主库、从库1的数据是不一致的，gtid_test14表时不存在的，因此需要使用pt-table-checksum和pt-table-sync去同步，还用另一种方法是直接备份一份主节点的最近数据，在从库2上恢复。</null></null></null></p>

      
    </div>
    
  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/mysql/">mysql</a>
    </span>
    

    </div>

    
  </div>
  
    
    
  
</article>
   
    <div id="toc" class="toc-article ">
    <div class="toc-title">目录</div>
    <ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#0、实验环境介绍："><span class="toc-number">1.</span> <span class="toc-text">0、实验环境介绍：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1、实验一，手动删除主库binlog日志文件"><span class="toc-number">2.</span> <span class="toc-text">1、实验一，手动删除主库binlog日志文件</span></a></li></ol>
</div>


  

	<!-- async load  -->
	<script>
			function async(u, c) {
				var d = document, t = 'script',
						o = d.createElement(t),
						s = d.getElementsByTagName(t)[0];
				o.src = u;
				if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
				s.parentNode.insertBefore(o, s);
			}
	</script>
	<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
	<script>
			async("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
					anchors.options = {
						visible: 'hover',
						placement: 'left',
						// icon: '#'
					};
					anchors.add().remove('.article-title').remove('.subheading').remove('.sidebar-container h5');
			})
	</script>
	<style>
			/* place left on bigger screen */
			@media all and (min-width: 800px) {
					.anchorjs-link{
							position: absolute;
							left: -0.75em;
							font-size: 1.1em;
							margin-top : -0.1em;
					}
			}
	</style>




<!-- UY BEGIN -->
	<div id="gitment-container"></div>
	<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
	<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
	<script src="/js/web-pinyin.js"></script>
	<script>
		function toUnicode(s){ 
			return s.replace(/([\u4E00-\u9FA5]|[\uFE30-\uFFA0])/g,function(){
			return "\\u" + RegExp["$1"].charCodeAt(0).toString(16);
			});
		}
		var title = '[Mysql] mysql-mgr模拟the master has purged binary logs containing GTIDs that the slave requires.&#39;, Error_code: 1236'
		var GitHub_id = 'zeven0707'
		var client_id = '2b0cc50fd55624b20d70'
		var client_secret = '489e4e840e0186f96ad172932b583e2fe68729c8'
		var repo = 'zeven0707.github.io'
		var gitment = new Gitment({
		// id: '页面 ID', // 可选。默认为 location.href
		// id:"11" ,
		id: title,
		title: title,
		owner: GitHub_id,//'你的 GitHub ID',
		repo: repo,//'存储评论的 repo',
		oauth: {
			client_id: client_id,//'你的 client ID',
			client_secret: client_secret,//'你的 client secret',
		},
		})
		gitment.render('gitment-container')
	</script>
<!-- UY END -->




            </main>
          </div>
        </div>
       
    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/BosenY/Lap" target="_blank">Lap</a>
    <br/><span id="busuanzi_container_site_uv"> 
  本站访客数<span id="busuanzi_value_site_uv"></span>人次
</span>
    </br>
    
      
        &copy; 2018 zeven0707&#39;s blog
      
    
  </p>
</footer>
    
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-92842840-1', 'auto');
    ga('send', 'pageview');

</script>


  </div>

</div>
<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script src="https://cdn.bootcss.com/vue/2.5.13/vue.min.js"></script>
<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

  <script src="https://unpkg.com/draw-something/dist/draw.min.js"></script>
  <script>
    let maxNum = Number.parseInt('30')
    let iconText = '❤'
    let color = 'red'
    new Draw({maxNum, iconText, color})
  </script>

<script src="/js/index.js"></script>
<script src="/js/search.js"></script>

</body>
</html>