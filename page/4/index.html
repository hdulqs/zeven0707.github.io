<!DOCTYPE HTML>
<html>
<head >
  <meta charset="utf-8">
  
  <title>第 4 页 | zeven&#39;s blog</title>

  
  <meta name="author" content="zeven0707&#39;s blog">
  

  

  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  

  <meta property="og:site_name" content="zeven&#39;s blog"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  
  
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-5005349780815724",
    enable_page_level_ads: true
  });
</script>

  
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?223eea22355699157e147870eb124b24";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>


  <link rel="manifest" href="/manifest.json">
  <link href="/favicon.ico" rel="icon">

  <link rel="alternate" href="/atom.xml" title="zeven&#39;s blog" type="application/atom+xml">
  <link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/base/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">


</head>


<body>
<div class="blog">
  <div class="content">

    

    <header class="header-container" style="background-image: url('/images/blog-bg.jpg');">


<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <div class="navbar-header page-scroll">
          <button type="button" id="tglBtn" class="navbar-toggle">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">zeven0707&#39;s blog</a>
        </div>
        <div id="bosenyblog-navbar">
          <div class="navbar-collapse" id="bs-example-navbar-collapse-6">
            <ul class="nav navbar-nav navbar-right">
            
              <li><a href="/">主页</a></li>
            
              <li><a href="/archives">日志</a></li>
            
              <li><a href="/about">关于</a></li>
            
              <li><a href="/tags">标签</a></li>
            
            </ul>
          </div>
        </div>

    </div>
 </nav>
 <div class="gotop-btn">

 </div>
</header>

        
        <div class="container ">
          <div class="row">
            <main class="site-main posts-loop    col-lg-8 col-lg-offset-1
                    col-md-8 col-md-offset-1
                    col-sm-12
                    col-xs-12">
            
  <article class="article-container ">

  
    
    <h3 class="article-title"><a href="/2018/10/28/Old incarnation found while trying to add node/"><span>[Mysql] Old incarnation found while trying to add node</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2018/10/28/Old incarnation found while trying to add node/" rel="bookmark">
        <time class="entry-date published" datetime="2018-10-28T15:25:00.000Z">
          2018-10-28
        </time>
      </a>
    </span>
    <br />
    
  </div>


  

  <div class="article-content">
    <div class="entry">
      
          <h4 id="0、集群环境介绍"><a href="#0、集群环境介绍" class="headerlink" title="0、集群环境介绍"></a>0、集群环境介绍</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql-mgr单主集群：</span><br><span class="line">mw-mysql-1：primary（节点1）</span><br><span class="line">mw-mysql-2：second （节点2）</span><br><span class="line">mw-mysql-3：second （节点3）</span><br></pre></td></tr></table></figure>
<h4 id="1、收到zabbix报警mysql-mgr集群有一个节点down，查看节点信息，内容如下"><a href="#1、收到zabbix报警mysql-mgr集群有一个节点down，查看节点信息，内容如下" class="headerlink" title="1、收到zabbix报警mysql-mgr集群有一个节点down，查看节点信息，内容如下"></a>1、收到zabbix报警mysql-mgr集群有一个节点down，查看节点信息，内容如下</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select * from performance_schema.replication_group_members;</span><br><span class="line">+---------------------------+--------------------------------------+-------------+-------------+--------------+</span><br><span class="line">| CHANNEL_NAME              | MEMBER_ID                            | MEMBER_HOST | MEMBER_PORT | MEMBER_STATE |</span><br><span class="line">+---------------------------+--------------------------------------+-------------+-------------+--------------+</span><br><span class="line">| group_replication_applier | 77039511-8e42-11e8-b6d4-000d3aa1a189 | mw-mysql-1  |        3306 | ONLINE       |</span><br><span class="line">| group_replication_applier | 81143c99-8e3d-11e8-a501-000d3aa1b575 | mw-mysql-2  |        3306 | ONLINE       |</span><br><span class="line">| group_replication_applier | 8bab920f-8e3d-11e8-a045-000d3aa09b70 | mw-mysql-3  |        3306 | UNREACHABLE  |</span><br><span class="line">+---------------------------+--------------------------------------+-------------+-------------+--------------+</span><br></pre></td></tr></table></figure>
<p>因为还有两个节点节点存活，表示集群还是可用的。（后面才发现只依靠这个信息是错误的）</p>
<h4 id="2、节点3集群状态变为不可达，查看节点3的日志："><a href="#2、节点3集群状态变为不可达，查看节点3的日志：" class="headerlink" title="2、节点3集群状态变为不可达，查看节点3的日志："></a>2、节点3集群状态变为不可达，查看节点3的日志：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> waited (count) when Workers occupied = 590 waited when Workers occupied = 11412795300</span><br><span class="line">2018-10-27T06:56:10.116159Z 0 [Warning] Plugin group_replication reported: &apos;The member with address mw-mysql-2:3306 has already sent the stable set. Therefore discarding the second message.&apos;</span><br><span class="line">xdr_bytes: out of memory</span><br><span class="line">xdr_bytes: out of memory</span><br><span class="line">xdr_bytes: out of memory</span><br><span class="line">2018-10-27T06:58:03.284079Z 0 [Note] Plugin group_replication reported: &apos;dispatch_op /export/home/pb2/build/sb_0-27500212-1520171728.22/mysql-5.7.22/rapid/plugin/group_replication/libmysqlgcs/src/bindings/xcom/xcom/xcom_base.c:3810 die_op executed_msg=&#123;53f6a873 47559528 0&#125; delivered_msg=&#123;53f6a873 47559528 0&#125; p-&gt;synode=&#123;53f6a873 47559501 0&#125; p-&gt;delivered_msg=&#123;53f6a873 47559525 0&#125; p-&gt;max_synode=&#123;53f6a873 47559528 1&#125; &apos;</span><br><span class="line">2018-10-27T06:58:03.285626Z 0 [Note] Plugin group_replication reported: &apos;dispatch_op /export/home/pb2/build/sb_0-27500212-1520171728.22/mysql-5.7.22/rapid/plugin/group_replication/libmysqlgcs/src/bindings/xcom/xcom/xcom_base.c:3810 die_op executed_msg=&#123;53f6a873 47559528 0&#125; delivered_msg=&#123;53f6a873 47559528 0&#125; p-&gt;synode=&#123;53f6a873 47559501 0&#125; p-&gt;delivered_msg=&#123;53f6a873 47559525 0&#125; p-&gt;max_synode=&#123;53f6a873 47559528 2&#125; &apos;</span><br></pre></td></tr></table></figure>
<h4 id="3、节点3因为内存不足导致节点集群进程down掉，重新启动mysql，尝试将节点3加入集群，提示加入失败："><a href="#3、节点3因为内存不足导致节点集群进程down掉，重新启动mysql，尝试将节点3加入集群，提示加入失败：" class="headerlink" title="3、节点3因为内存不足导致节点集群进程down掉，重新启动mysql，尝试将节点3加入集群，提示加入失败："></a>3、节点3因为内存不足导致节点集群进程down掉，重新启动mysql，尝试将节点3加入集群，提示加入失败：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">2018-10-27T07:49:40.493156Z 33 [Note] Plugin group_replication reported: &apos;Group communication SSL configuration: group_replication_ssl_mode: &quot;DISABLED&quot;&apos;</span><br><span class="line">2018-10-27T07:49:40.493724Z 33 [Note] Plugin group_replication reported: &apos;[GCS] Added automatically IP ranges 10.1.150.12/24,10.1.150.16/24,127.0.0.1/8 to the whitelist&apos;</span><br><span class="line">2018-10-27T07:49:40.494212Z 33 [Note] Plugin group_replication reported: &apos;[GCS] Translated &apos;mw-mysql-3&apos; to 10.1.150.16&apos;</span><br><span class="line">2018-10-27T07:49:40.494374Z 33 [Warning] Plugin group_replication reported: &apos;[GCS] Automatically adding IPv4 localhost address to the whitelist. It is mandatory that it is added.&apos;</span><br><span class="line">2018-10-27T07:49:40.494426Z 33 [Note] Plugin group_replication reported: &apos;[GCS] SSL was not enabled&apos;</span><br><span class="line">2018-10-27T07:49:40.494453Z 33 [Note] Plugin group_replication reported: &apos;Initialized group communication with configuration: group_replication_group_name: &quot;9275d4e4-8e42-11e8-b217-000d3aa1a189&quot;; group_replication_local_address: &quot;mw-mysql-3:24901&quot;; group_replication_group_seeds: &quot;mw-mysql-1:24901,mw-mysql-2:24901,mw-mysql-3:24901&quot;; group_replication_bootstrap_group: false; group_replication_poll_spin_loops: 0; group_replication_compression_threshold: 1000000; group_replication_ip_whitelist: &quot;AUTOMATIC&quot;&apos;</span><br><span class="line">2018-10-27T07:49:40.494471Z 33 [Note] Plugin group_replication reported: &apos;[GCS] Configured number of attempts to join: 0&apos;</span><br><span class="line">2018-10-27T07:49:40.494476Z 33 [Note] Plugin group_replication reported: &apos;[GCS] Configured time between attempts to join: 5 seconds&apos;</span><br><span class="line">2018-10-27T07:49:40.494526Z 33 [Note] Plugin group_replication reported: &apos;Member configuration: member_id: 3306101; member_uuid: &quot;8bab920f-8e3d-11e8-a045-000d3aa09b70&quot;; single-primary mode: &quot;true&quot;; group_replication_auto_increment_increment: 1; &apos;</span><br><span class="line">2018-10-27T07:49:40.494937Z 94 [Note] &apos;CHANGE MASTER TO FOR CHANNEL &apos;group_replication_applier&apos; executed&apos;. Previous state master_host=&apos;&lt;NULL&gt;&apos;, master_port= 0, master_log_file=&apos;&apos;, master_log_pos= 4, master_bind=&apos;&apos;. New state master_host=&apos;&lt;NULL&gt;&apos;, master_port= 0, master_log_file=&apos;&apos;, master_log_pos= 4, master_bind=&apos;&apos;.</span><br><span class="line">2018-10-27T07:49:40.545004Z 97 [Note] Slave SQL thread for channel &apos;group_replication_applier&apos; initialized, starting replication in log &apos;FIRST&apos; at position 0, relay log &apos;./relay-log-group_replication_applier.000508&apos; position: 4</span><br><span class="line">2018-10-27T07:49:40.545034Z 33 [Note] Plugin group_replication reported: &apos;Group Replication applier module successfully initialized!&apos;</span><br><span class="line">2018-10-27T07:49:40.545059Z 33 [Note] Plugin group_replication reported: &apos;auto_increment_increment is set to 1&apos;</span><br><span class="line">2018-10-27T07:49:40.545063Z 33 [Note] Plugin group_replication reported: &apos;auto_increment_offset is set to 3306101&apos;</span><br><span class="line">2018-10-27T07:49:40.545486Z 0 [Note] Plugin group_replication reported: &apos;XCom protocol version: 3&apos;</span><br><span class="line">2018-10-27T07:49:40.545513Z 0 [Note] Plugin group_replication reported: &apos;XCom initialized and ready to accept incoming connections on port 24901&apos;</span><br><span class="line">2018-10-27T07:49:40.762663Z 0 [Warning] Plugin group_replication reported: &apos;read failed&apos;</span><br><span class="line">2018-10-27T07:49:40.780216Z 0 [ERROR] Plugin group_replication reported: &apos;[GCS] The member was unable to join the group. Local port: 24901&apos;</span><br></pre></td></tr></table></figure>
<h4 id="4、因为在节点3查不到任何有用的报错信息，尝试在节点1查看有没有其他报错，看到一条比较奇怪的报错："><a href="#4、因为在节点3查不到任何有用的报错信息，尝试在节点1查看有没有其他报错，看到一条比较奇怪的报错：" class="headerlink" title="4、因为在节点3查不到任何有用的报错信息，尝试在节点1查看有没有其他报错，看到一条比较奇怪的报错："></a>4、因为在节点3查不到任何有用的报错信息，尝试在节点1查看有没有其他报错，看到一条比较奇怪的报错：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[Note] Plugin group_replication reported: &apos;Old incarnation found while trying to add node mw-mysql-3:24901 15406269616484810.&apos;</span><br></pre></td></tr></table></figure>
<p>官方文档没有关于这个信息的任何提示，在这个链接<a href="https://dba.stackexchange.com/questions/214779/how-to-delete-previous-incarnation-in-mysql-w-group-replication查到碰到这个问题只能重启集群。" target="_blank" rel="noopener">https://dba.stackexchange.com/questions/214779/how-to-delete-previous-incarnation-in-mysql-w-group-replication查到碰到这个问题只能重启集群。</a></p>
<h4 id="5、查看节点2的信息，error-log没有任何更新，正常情况下如果集群节点正常应该会每个120s左右，会刷新一下信息："><a href="#5、查看节点2的信息，error-log没有任何更新，正常情况下如果集群节点正常应该会每个120s左右，会刷新一下信息：" class="headerlink" title="5、查看节点2的信息，error.log没有任何更新，正常情况下如果集群节点正常应该会每个120s左右，会刷新一下信息："></a>5、查看节点2的信息，error.log没有任何更新，正常情况下如果集群节点正常应该会每个120s左右，会刷新一下信息：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[Note] Multi-threaded slave statistics for channel &apos;group_replication_applier&apos;: seconds elapsed = 131; events assigned = 3687425; worker queues filled over overrun level = 0; waited due a Worker queue full = 0; waited due the total size = 0; waited at clock conflicts = 65388998400 waited (count) when Workers occupied = 25728 waited when Workers occupied = 124142987600</span><br></pre></td></tr></table></figure>
<h4 id="6、查看节点1应用连接是正常的，但是dml操作一直hang主，没有任何结果，重新启动应用程序问题照旧。感觉集群状态虽然查询正常，但是已经不能提供对外服务了，最后决定把所有的库stop，重新集群系统，最后集群恢复正常，对外提供服务正常，查询集群服务正常："><a href="#6、查看节点1应用连接是正常的，但是dml操作一直hang主，没有任何结果，重新启动应用程序问题照旧。感觉集群状态虽然查询正常，但是已经不能提供对外服务了，最后决定把所有的库stop，重新集群系统，最后集群恢复正常，对外提供服务正常，查询集群服务正常：" class="headerlink" title="6、查看节点1应用连接是正常的，但是dml操作一直hang主，没有任何结果，重新启动应用程序问题照旧。感觉集群状态虽然查询正常，但是已经不能提供对外服务了，最后决定把所有的库stop，重新集群系统，最后集群恢复正常，对外提供服务正常，查询集群服务正常："></a>6、查看节点1应用连接是正常的，但是dml操作一直hang主，没有任何结果，重新启动应用程序问题照旧。感觉集群状态虽然查询正常，但是已经不能提供对外服务了，最后决定把所有的库stop，重新集群系统，最后集群恢复正常，对外提供服务正常，查询集群服务正常：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select * from performance_schema.replication_group_members;</span><br><span class="line">+---------------------------+--------------------------------------+-------------+-------------+--------------+</span><br><span class="line">| CHANNEL_NAME              | MEMBER_ID                            | MEMBER_HOST | MEMBER_PORT | MEMBER_STATE |</span><br><span class="line">+---------------------------+--------------------------------------+-------------+-------------+--------------+</span><br><span class="line">| group_replication_applier | 77039511-8e42-11e8-b6d4-000d3aa1a189 | mw-mysql-1  |        3306 | ONLINE       |</span><br><span class="line">| group_replication_applier | 81143c99-8e3d-11e8-a501-000d3aa1b575 | mw-mysql-2  |        3306 | ONLINE       |</span><br><span class="line">| group_replication_applier | 8bab920f-8e3d-11e8-a045-000d3aa09b70 | mw-mysql-3  |        3306 | ONLINE       |</span><br><span class="line">+---------------------------+--------------------------------------+-------------+-------------+--------------+</span><br></pre></td></tr></table></figure>

      
    </div>
    
  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/mysql/">mysql</a>
    </span>
    

    </div>

    
  </div>
  
    
    <h3 class="article-read"><a href="/2018/10/28/Old incarnation found while trying to add node/"><span>点击阅读</span></a></h3>
    
  
</article>





  <article class="article-container ">

  
    
    <h3 class="article-title"><a href="/2018/10/25/安装mysqlclient客户端/"><span>[Mysql] yum安装mysql-client客户端(centos7)</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2018/10/25/安装mysqlclient客户端/" rel="bookmark">
        <time class="entry-date published" datetime="2018-10-25T14:30:00.000Z">
          2018-10-25
        </time>
      </a>
    </span>
    <br />
    
  </div>


  

  <div class="article-content">
    <div class="entry">
      
          <h4 id="1、配置yum源"><a href="#1、配置yum源" class="headerlink" title="1、配置yum源"></a>1、配置yum源</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;[mysql80-community]</span><br><span class="line">name=MySQL 8.0 Community Server</span><br><span class="line">baseurl=http://repo.mysql.com/yum/mysql-8.0-community/el/7/\$basearch/</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=0</span><br><span class="line">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-mysql&quot; &gt; /etc/yum.repos.d/mysql-community.repo</span><br></pre></td></tr></table></figure>
<h4 id="2、查看配置文件是否正确"><a href="#2、查看配置文件是否正确" class="headerlink" title="2、查看配置文件是否正确:"></a>2、查看配置文件是否正确:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">more /etc/yum.repos.d/mysql-community.repo</span><br></pre></td></tr></table></figure>
<h4 id="3、安装mysql-client："><a href="#3、安装mysql-client：" class="headerlink" title="3、安装mysql-client："></a>3、安装mysql-client：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum clean all</span><br><span class="line">yum install mysql-community-client</span><br></pre></td></tr></table></figure>
      
    </div>
    
  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/mysql/">mysql</a>
    </span>
    

    </div>

    
  </div>
  
    
    <h3 class="article-read"><a href="/2018/10/25/安装mysqlclient客户端/"><span>点击阅读</span></a></h3>
    
  
</article>





  <article class="article-container ">

  
    
    <h3 class="article-title"><a href="/2018/10/25/mysql数据库使用innobackupex和mysqldump备份恢复的对比/"><span>[Mysql] mysql数据库使用innobackupex和mysqldump备份恢复的对比</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2018/10/25/mysql数据库使用innobackupex和mysqldump备份恢复的对比/" rel="bookmark">
        <time class="entry-date published" datetime="2018-10-25T14:30:00.000Z">
          2018-10-25
        </time>
      </a>
    </span>
    <br />
    
  </div>


  

  <div class="article-content">
    <div class="entry">
      
          <h4 id="1、查看原库数据文件大小："><a href="#1、查看原库数据文件大小：" class="headerlink" title="1、查看原库数据文件大小："></a>1、查看原库数据文件大小：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">du -sh *|grep data</span><br><span class="line">23G	data</span><br></pre></td></tr></table></figure>
<h4 id="2、使用innodbackex备份数据"><a href="#2、使用innodbackex备份数据" class="headerlink" title="2、使用innodbackex备份数据"></a>2、使用innodbackex备份数据</h4><p>在percona官方下载xtrabackup软件，并解压<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://www.percona.com/downloads/XtraBackup/Percona-XtraBackup-2.4.9/binary/tarball/percona-xtrabackup-2.4.9-Linux-x86_64.tar.gz</span><br><span class="line">tar -zxvf percona-xtrabackup-2.4.9-Linux-x86_64.tar.gz</span><br></pre></td></tr></table></figure></p>
<p>开始执行备份，指定配置文件、用户名、密码、端口、备份的目录<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./innobackupex --defaults-file=/etc/my.cnf --user=root --password=12345678 --port=3306 /data/</span><br></pre></td></tr></table></figure></p>
<p>（总体耗时25分钟左右，备份文件大小23G）</p>
<h4 id="3、采用innodbackex备份出来的数据去恢复-将数据文件拷贝到节点1-执行恢复操作"><a href="#3、采用innodbackex备份出来的数据去恢复-将数据文件拷贝到节点1-执行恢复操作" class="headerlink" title="3、采用innodbackex备份出来的数据去恢复,将数据文件拷贝到节点1,执行恢复操作:"></a>3、采用innodbackex备份出来的数据去恢复,将数据文件拷贝到节点1,执行恢复操作:</h4><p>先把事务日志恢复（–apply-log）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/data/soft/percona-xtrabackup/bin/innobackupex --defaults-file=/etc/my.cnf --user=root --password=12345678 --port=3306 --apply-log /data/2018-09-14_13-34-38</span><br></pre></td></tr></table></figure></p>
<p>恢复数据之前需要清除数据目录下的所有数据：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm -rf /data/mysql/data/*</span><br></pre></td></tr></table></figure></p>
<p>开始恢复数据<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/data/soft/percona-xtrabackup/bin/innobackupex --defaults-file=/etc/my.cnf --user=root --password=12345678 --port=3306 --copy-back --rsync /data/2018-09-14_13-34-38</span><br></pre></td></tr></table></figure></p>
<p>数据恢复完成之后，删除datadir下的事务日志log文件（innodb引擎才会有）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell &gt; cd /data/mysql/data</span><br><span class="line">shell &gt; rm -rf ib_logfile*</span><br></pre></td></tr></table></figure></p>
<p>设置数据目录权限<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell &gt; chown -R mysql:mysql /data/mysql/data</span><br><span class="line">shell &gt; /data/mysql/bin/mysqld_safe --defaults-file=/data/mysql/etc/my.cnf &amp;</span><br></pre></td></tr></table></figure></p>
<p>启动节点1的mysql<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/mysql restart</span><br></pre></td></tr></table></figure></p>
<p>恢复总体耗时（35分钟）</p>
<h4 id="4、原库使用mysqldump方法备份一份数据，用于恢复节点2："><a href="#4、原库使用mysqldump方法备份一份数据，用于恢复节点2：" class="headerlink" title="4、原库使用mysqldump方法备份一份数据，用于恢复节点2："></a>4、原库使用mysqldump方法备份一份数据，用于恢复节点2：</h4><p>原库操作<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/data/mysql/bin/mysqldump --all-databases --set-gtid-purged=ON --single-transaction -uroot -p12345678 &gt; /db/test.dump</span><br></pre></td></tr></table></figure></p>
<p>备份需要指定–set-gtid-purged=ON参数在备份文件中输出global.gtid_purged信息，<br>指定–single-transaction参数避免备份过程中产生锁<br>（备份耗时10分钟，备份文件大小11G）</p>
<h4 id="5、将mysqldump备份出的数据拷贝到节点2，节点2进行恢复操作："><a href="#5、将mysqldump备份出的数据拷贝到节点2，节点2进行恢复操作：" class="headerlink" title="5、将mysqldump备份出的数据拷贝到节点2，节点2进行恢复操作："></a>5、将mysqldump备份出的数据拷贝到节点2，节点2进行恢复操作：</h4><p> 如果从库@@GLOBAL.GTID_EXECUTED值不为空需要执行reset master;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@db 07:55:  [(none)]&gt; stop group_replication;</span><br><span class="line">Query OK, 0 rows affected (1.01 sec)</span><br><span class="line">root@db 07:55:  [(none)]&gt; reset master;</span><br><span class="line">Query OK, 0 rows affected (0.05 sec)</span><br></pre></td></tr></table></figure></p>
<p>开始执行恢复<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@dax-mysql-mha bin]# mysql -u root -p12345678 &lt; /data/test.dump</span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br></pre></td></tr></table></figure></p>
<p>总体耗时（60分钟左右）</p>
<h4 id="6、关于使用mysqldump备份恢复和innobackupex备份恢复的比较："><a href="#6、关于使用mysqldump备份恢复和innobackupex备份恢复的比较：" class="headerlink" title="6、关于使用mysqldump备份恢复和innobackupex备份恢复的比较："></a>6、关于使用mysqldump备份恢复和innobackupex备份恢复的比较：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">数据文件目录大小23G情况下，mysqldump逻辑备份出来数据大小11G，备份耗时十分钟，恢复耗时一小时；</span><br><span class="line">innobackupex物理备份备份出来数据大小23G，备份耗时25分钟，恢复耗时35分钟。</span><br><span class="line">使用物理备份备份时间比逻辑备份时间较长，但恢复时间会小于逻辑备份时间,数据量比较大的情况下使用innobackupex会更好一点。</span><br></pre></td></tr></table></figure>

      
    </div>
    
  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/mysql/">mysql</a>
    </span>
    

    </div>

    
  </div>
  
    
    <h3 class="article-read"><a href="/2018/10/25/mysql数据库使用innobackupex和mysqldump备份恢复的对比/"><span>点击阅读</span></a></h3>
    
  
</article>





  <article class="article-container ">

  
    
    <h3 class="article-title"><a href="/2018/10/25/mysql-MGR集群配置/"><span>[Mysql] mysql-MGR集群配置</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2018/10/25/mysql-MGR集群配置/" rel="bookmark">
        <time class="entry-date published" datetime="2018-10-25T14:06:00.000Z">
          2018-10-25
        </time>
      </a>
    </span>
    <br />
    
  </div>


  

  <div class="article-content">
    <div class="entry">
      
          <h4 id="前提须知：mgr限制条件"><a href="#前提须知：mgr限制条件" class="headerlink" title="前提须知：mgr限制条件"></a>前提须知：mgr限制条件</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">仅支持InnoDB表，并且每张表一定要有一个主键，用于做write set的冲突检测；必须打开GTID特性，二进制日志格式必须设置为ROW，用于选主与write set</span><br><span class="line">COMMIT可能会导致失败，类似于快照事务隔离级别的失败场景</span><br><span class="line">目前一个MGR集群最多支持9个节点</span><br><span class="line">不支持外键于save point特性，无法做全局间的约束检测与部分部分回滚</span><br><span class="line">二进制日志不支持binlog event checksum</span><br></pre></td></tr></table></figure>
<h4 id="0、修改每个节点hosts文件，如下面所示-三个节点均需修改"><a href="#0、修改每个节点hosts文件，如下面所示-三个节点均需修改" class="headerlink" title="0、修改每个节点hosts文件，如下面所示(三个节点均需修改)"></a>0、修改每个节点hosts文件，如下面所示(三个节点均需修改)</h4><p>[root@dax-mysql-master log]# cat /etc/hosts<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line">10.0.7.53   dax-mysql-master</span><br><span class="line">10.0.7.50   dax-mysql-slave</span><br><span class="line">10.0.7.51   dax-mysql-mha</span><br></pre></td></tr></table></figure></p>
<h4 id="1、修改三个节点的my-cnf配置文件，在-mysqld-后添加如下信息，local-address这一行配置为自己的ip地址，其他不变"><a href="#1、修改三个节点的my-cnf配置文件，在-mysqld-后添加如下信息，local-address这一行配置为自己的ip地址，其他不变" class="headerlink" title="1、修改三个节点的my.cnf配置文件，在[mysqld]后添加如下信息，local_address这一行配置为自己的ip地址，其他不变"></a>1、修改三个节点的my.cnf配置文件，在[mysqld]后添加如下信息，local_address这一行配置为自己的ip地址，其他不变</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">master_info_repository = &quot;TABLE&quot;</span><br><span class="line">relay_log_info_repository = &quot;TABLE&quot;</span><br><span class="line">transaction_write_set_extraction = &quot;XXHASH64&quot;</span><br><span class="line">slave_parallel_workers = 2</span><br><span class="line">slave_preserve_commit_order = 1</span><br><span class="line">slave_parallel_type = &quot;LOGICAL_CLOCK&quot;</span><br><span class="line">binlog_checksum = NONE</span><br><span class="line">#group_replication_allow_local_disjoint_gtids_join = ON</span><br><span class="line">#group_replication_auto_increment_increment = 1</span><br><span class="line">loose-group_replication_group_name = &quot;867fee38-746b-11e8-b006-000d3a800ed3&quot;</span><br><span class="line">loose-group_replication_start_on_boot = off</span><br><span class="line">loose-group_replication_local_address = &quot;dax-mysql-mha:24901&quot;</span><br><span class="line">loose-group_replication_group_seeds = &quot;dax-mysql-master:24901,dax-mysql-slave:24901,dax-mysql-mha:24901&quot;</span><br><span class="line">loose-group_replication_bootstrap_group = off</span><br></pre></td></tr></table></figure>
<p>集群参数详解：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#group_replication_auto_increment_increment = 1 单主模式下可以设置为1（每个节点都要设置，不设置默认仍然为7）</span><br><span class="line">#loose-用于上述group_replication变量 的前缀 指示服务器在服务器启动时尚未加载组复制插件时继续启动。</span><br><span class="line">#配置会 transaction_write_set_extraction 指示服务器为每个事务处理它必须收集写入集并使用XXHASH64散列算法将其编码为 散列。</span><br><span class="line">#配置会 group_replication_group_name 告诉插件它正在加入或创建的组名为“aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa”。</span><br><span class="line">#值 group_replication_group_name 必须是有效的UUID。在二进制日志中为组复制事件设置GTID时，此UUID在内部使用。使用SELECT UUID();生成一个UUID。</span><br><span class="line">#配置 group_replication_start_on_boot 指示插件在服务器启动时不自动启动操作。这在设置组复制时很重要，因为它可以确保您可以在手动启动#插件之前配置服务器。成员配置完成后，您可以将其设置 group_replication_start_on_boot 为开启，以便在服务器引导时自动启动组复制。</span><br><span class="line">#配置 group_replication_local_address 告诉插件使用网络地址127.0.0.1和端口24901与组中的其他成员进行内部通信。</span><br></pre></td></tr></table></figure></p>
<p>添加完参数之后重启数据库（三个节点均需重启）</p>
<h4 id="2、主节点1-dax-mysql-master-执行："><a href="#2、主节点1-dax-mysql-master-执行：" class="headerlink" title="2、主节点1(dax-mysql-master)执行："></a>2、主节点1(dax-mysql-master)执行：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; </span><br><span class="line">SET SQL_LOG_BIN=0;</span><br><span class="line">CREATE USER repl@&apos;%&apos; IDENTIFIED BY &apos;12345678&apos;;</span><br><span class="line">GRANT REPLICATION SLAVE ON *.* TO repl@&apos;%&apos;;</span><br><span class="line">FLUSH PRIVILEGES;</span><br><span class="line">SET SQL_LOG_BIN=1;</span><br><span class="line">CHANGE MASTER TO MASTER_USER=&apos;repl&apos;, MASTER_PASSWORD=&apos;12345678&apos; FOR CHANNEL &apos;group_replication_recovery&apos;;</span><br><span class="line">#安装组复制插件</span><br><span class="line">INSTALL PLUGIN group_replication SONAME &apos;group_replication.so&apos;;</span><br><span class="line">#查看插件是否安装成功</span><br><span class="line">SHOW PLUGINS;</span><br></pre></td></tr></table></figure>
<p>插件安装完成之后，将配置文件注释的那两行#去掉，重启数据库，并启动组复制进程：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#启动组复制</span><br><span class="line">SET GLOBAL group_replication_bootstrap_group=ON;</span><br><span class="line">START GROUP_REPLICATION;</span><br><span class="line">SET GLOBAL group_replication_bootstrap_group=OFF;</span><br><span class="line">#查看组成员</span><br><span class="line">SELECT * FROM performance_schema.replication_group_members;</span><br></pre></td></tr></table></figure></p>
<h5 id="2-1、创建数据，可在添加其他节点之前加，或者之后加（测试在节点之前加，添加其他节点后，会自动同步）-该步骤可选择性执行"><a href="#2-1、创建数据，可在添加其他节点之前加，或者之后加（测试在节点之前加，添加其他节点后，会自动同步）-该步骤可选择性执行" class="headerlink" title="2.1、创建数据，可在添加其他节点之前加，或者之后加（测试在节点之前加，添加其他节点后，会自动同步）(该步骤可选择性执行)"></a>2.1、创建数据，可在添加其他节点之前加，或者之后加（测试在节点之前加，添加其他节点后，会自动同步）(该步骤可选择性执行)</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;</span><br><span class="line">CREATE DATABASE test1;</span><br><span class="line">USE test;</span><br><span class="line">CREATE TABLE t4 (c1 INT PRIMARY KEY, c2 TEXT NOT NULL);</span><br><span class="line">INSERT INTO t4 VALUES (1, &apos;Luis&apos;);</span><br><span class="line">检查表t1和二进制日志的内容。</span><br><span class="line">SELECT * FROM t4;</span><br><span class="line">SHOW BINLOG EVENTS;</span><br></pre></td></tr></table></figure>
<h4 id="3、从节点2（dax-mysql-slave）执行"><a href="#3、从节点2（dax-mysql-slave）执行" class="headerlink" title="3、从节点2（dax-mysql-slave）执行:"></a>3、从节点2（dax-mysql-slave）执行:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SET SQL_LOG_BIN=0;</span><br><span class="line">CREATE USER repl@&apos;%&apos; IDENTIFIED BY &apos;12345678&apos;;</span><br><span class="line">GRANT REPLICATION SLAVE ON *.* TO repl@&apos;%&apos;;</span><br><span class="line">FLUSH PRIVILEGES;</span><br><span class="line">SET SQL_LOG_BIN=1;</span><br><span class="line">CHANGE MASTER TO MASTER_USER=&apos;repl&apos;, MASTER_PASSWORD=&apos;12345678&apos; FOR CHANNEL &apos;group_replication_recovery&apos;;</span><br><span class="line">INSTALL PLUGIN group_replication SONAME &apos;group_replication.so&apos;;</span><br><span class="line">show plugins;</span><br></pre></td></tr></table></figure>
<p>将配置文件注释的那两行#去掉，重启数据库<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;START GROUP_REPLICATION;</span><br></pre></td></tr></table></figure></p>
<h4 id="4、从节点3-dax-mysql-mha-执行"><a href="#4、从节点3-dax-mysql-mha-执行" class="headerlink" title="4、从节点3(dax-mysql-mha)执行:"></a>4、从节点3(dax-mysql-mha)执行:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SET SQL_LOG_BIN=0;</span><br><span class="line">CREATE USER repl@&apos;%&apos; IDENTIFIED BY &apos;12345678&apos;;</span><br><span class="line">GRANT REPLICATION SLAVE ON *.* TO repl@&apos;%&apos;;</span><br><span class="line">FLUSH PRIVILEGES;</span><br><span class="line">SET SQL_LOG_BIN=1;</span><br><span class="line">CHANGE MASTER TO MASTER_USER=&apos;repl&apos;, MASTER_PASSWORD=&apos;12345678&apos; FOR CHANNEL &apos;group_replication_recovery&apos;;</span><br><span class="line">INSTALL PLUGIN group_replication SONAME &apos;group_replication.so&apos;;</span><br><span class="line">show plugins;</span><br></pre></td></tr></table></figure>
<p>将配置文件注释的那两行#去掉，重启数据库<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;START GROUP_REPLICATION;</span><br></pre></td></tr></table></figure></p>
<h4 id="5、安装mysql-shell-只在主节点执行便可"><a href="#5、安装mysql-shell-只在主节点执行便可" class="headerlink" title="5、安装mysql-shell(只在主节点执行便可)"></a>5、安装mysql-shell(只在主节点执行便可)</h4><p>下载mysql-shell<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://dev.mysql.com/get/Downloads/MySQL-Shell/mysql-shell-8.0.11-linux-glibc2.12-x86-64bit.tar.gz</span><br></pre></td></tr></table></figure></p>
<p>MySQL Shell用来配置服务器以供InnoDB集群使用的供应脚本需要访问Python版本2.7。对于沙箱部署，在用于部署的单台机器上需要Python，生产部署需要在每个服务器实例上使用Python。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf mysql-shell-8.0.11-linux-glibc2.12-x86-64bit.tar.gz</span><br><span class="line">mv mysql-shell-8.0.11-linux-glibc2.12-x86-64bit mysql-shell</span><br></pre></td></tr></table></figure></p>
<p>主节点1（dax-mysql-master),连接主节点,授权repl用户集群管理权限<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GRANT ALL PRIVILEGES ON mysql_innodb_cluster_metadata.* TO repl@&apos;%&apos; identified by &apos;12345678&apos; WITH GRANT OPTION;</span><br><span class="line">GRANT RELOAD, SHUTDOWN, PROCESS, FILE, SUPER, REPLICATION SLAVE, REPLICATION CLIENT, CREATE USER ON *.* TO repl@&apos;%&apos; identified by &apos;12345678&apos; WITH GRANT OPTION;</span><br><span class="line">GRANT SELECT ON *.* TO repl@&apos;%&apos; identified by &apos;12345678&apos; WITH GRANT OPTION;</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure></p>
<p>通过mysql-shell连接到主节点1配置集群:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">/data/soft/mysql-shell/bin/mysqlsh --uri repl@dax-mysql-master:3306</span><br><span class="line">&lt;输入用户名</span><br><span class="line">mysql-shell&gt;dba.verbose=2</span><br><span class="line">创建集群</span><br><span class="line">mysql-shell&gt;var cluster = dba.createCluster(&apos;prodCluster&apos;, &#123;adoptFromGR: true&#125;);</span><br><span class="line">查看集群状态</span><br><span class="line">mysql-shell&gt;cluster = dba.getCluster(&quot;prodCluster&quot;)</span><br><span class="line">mysql-shell&gt;cluster.status()</span><br></pre></td></tr></table></figure></p>
<h4 id="6、在应用端安装mysql-router"><a href="#6、在应用端安装mysql-router" class="headerlink" title="6、在应用端安装mysql-router"></a>6、在应用端安装mysql-router</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo bash</span><br><span class="line">mkdir -p /data/soft</span><br><span class="line">cd /data/soft</span><br><span class="line">wget https://dev.mysql.com/get/Downloads/MySQL-Router/mysql-router-8.0.11-linux-glibc2.12-x86-64bit.tar.gz</span><br><span class="line">tar -zxvf mysql-router-8.0.11-linux-glibc2.12-x86-64bit.tar.gz</span><br><span class="line">mv  mysql-router-8.0.11-linux-glibc2.12-x86-64bit  mysql-router</span><br></pre></td></tr></table></figure>
<p>配置mysqlrouter<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/data/soft/mysql-router/bin/mysqlrouter --bootstrap repl@10.5.0.6:3306 --directory /data/soft/myrouter --user=root --conf-use-sockets --force</span><br></pre></td></tr></table></figure></p>
<p>在/data/soft/myrouter目录下生成关于mysqlrouter的配置文件，用于记录用于连接到mgr集群<br>其中mysqlrouter.conf配置文件内容如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">[metadata_cache:prodCluster]</span><br><span class="line">router_id=7</span><br><span class="line">bootstrap_server_addresses=mysql://dax-mysql-slave:3306,mysql://dax-mysql-master</span><br><span class="line">:3306,mysql://dax-mysql-mha:3306</span><br><span class="line">user=mysql_router7_umuf7ikos8fp</span><br><span class="line">metadata_cluster=prodCluster</span><br><span class="line">ttl=5</span><br><span class="line"></span><br><span class="line">[routing:prodCluster_default_rw]</span><br><span class="line">bind_address=0.0.0.0</span><br><span class="line">bind_port=6446</span><br><span class="line">socket=/tmp/myrouter/mysql.sock</span><br><span class="line">destinations=metadata-cache://prodCluster/default?role=PRIMARY</span><br><span class="line">routing_strategy=round-robin</span><br><span class="line">protocol=classic</span><br><span class="line"></span><br><span class="line">[routing:prodCluster_default_ro]</span><br><span class="line">bind_address=0.0.0.0</span><br><span class="line">bind_port=6447</span><br><span class="line">socket=/tmp/myrouter/mysqlro.sock</span><br><span class="line">destinations=metadata-cache://prodCluster/default?role=SECONDARY</span><br><span class="line">routing_strategy=round-robin</span><br><span class="line">protocol=classic</span><br><span class="line"></span><br><span class="line">[routing:prodCluster_default_x_rw]</span><br><span class="line">bind_address=0.0.0.0</span><br><span class="line">bind_port=64460</span><br><span class="line">socket=/tmp/myrouter/mysqlx.sock</span><br><span class="line">destinations=metadata-cache://prodCluster/default?role=PRIMARY</span><br><span class="line">routing_strategy=round-robin</span><br><span class="line">protocol=x</span><br><span class="line"></span><br><span class="line">[routing:prodCluster_default_x_ro]</span><br><span class="line">bind_address=0.0.0.0</span><br><span class="line">bind_port=64470</span><br><span class="line">socket=/tmp/myrouter/mysqlxro.sock</span><br><span class="line">destinations=metadata-cache://prodCluster/default?role=SECONDARY</span><br><span class="line">routing_strategy=round-robin</span><br><span class="line">protocol=x</span><br></pre></td></tr></table></figure></p>
<p>启动mysqlrouter命令：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/data/soft/myrouter/start.sh</span><br><span class="line">netstat -tunlp|grep mysql</span><br></pre></td></tr></table></figure></p>
<p>加入开机启动<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;</span><br><span class="line">rm -rf /data/soft/myrouter/mysqlrouter.pid </span><br><span class="line">/data/soft/myrouter/start.sh &quot; &gt;&gt; /etc/rc.local</span><br><span class="line">cat /etc/rc.local</span><br></pre></td></tr></table></figure></p>
<p>授权脚本执行权限<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod +x /etc/rc.d/rc.local</span><br><span class="line">ll /etc/rc.d/rc.local</span><br></pre></td></tr></table></figure></p>
<p>####7、测试连接库是否有问题，并查看连接的库是主还是从<br>连接读写库<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -h 127.0.0.1 -P 6446 -p</span><br></pre></td></tr></table></figure></p>
<p>连接只读库<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -h 127.0.0.1 -P 6447 -p</span><br></pre></td></tr></table></figure></p>
<h4 id="8、查看集群状态"><a href="#8、查看集群状态" class="headerlink" title="8、查看集群状态"></a>8、查看集群状态</h4><p>查看组成员<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM performance_schema.replication_group_members;</span><br></pre></td></tr></table></figure></p>
<p>查看主节点<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW STATUS LIKE &apos;group_replication_primary_member&apos;;</span><br></pre></td></tr></table></figure></p>
<p>或者使用如下方法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">set global show_compatibility_56 = on;</span><br><span class="line">select MEMBER_HOST from performance_schema.replication_group_members where MEMBER_ID=(select VARIABLE_VALUE from information_schema.global_status where variable_name=&apos;GROUP_REPLICATION_PRIMARY_MEMBER&apos;);</span><br></pre></td></tr></table></figure></p>

      
    </div>
    
  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/mysql/">mysql</a>
    </span>
    

    </div>

    
  </div>
  
    
    <h3 class="article-read"><a href="/2018/10/25/mysql-MGR集群配置/"><span>点击阅读</span></a></h3>
    
  
</article>





  <article class="article-container ">

  
    
    <h3 class="article-title"><a href="/2018/10/25/一台服务器安装多个mysql数据库程序/"><span>[Mysql] 一台服务器安装多个mysql数据库程序</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2018/10/25/一台服务器安装多个mysql数据库程序/" rel="bookmark">
        <time class="entry-date published" datetime="2018-10-25T03:17:00.000Z">
          2018-10-25
        </time>
      </a>
    </span>
    <br />
    
  </div>


  

  <div class="article-content">
    <div class="entry">
      
          <h4 id="1、已安装第一个mysql程序的相关信息："><a href="#1、已安装第一个mysql程序的相关信息：" class="headerlink" title="1、已安装第一个mysql程序的相关信息："></a>1、已安装第一个mysql程序的相关信息：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">端口：3306</span><br><span class="line">目录：/data/mysql/</span><br><span class="line">配置文件:/etc/my.cnf</span><br></pre></td></tr></table></figure>
<h4 id="2、新建用于第二个mysql程序的目录："><a href="#2、新建用于第二个mysql程序的目录：" class="headerlink" title="2、新建用于第二个mysql程序的目录："></a>2、新建用于第二个mysql程序的目录：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /data/twomysql</span><br></pre></td></tr></table></figure>
<p>将安装包解压到twomysql目录（下载地址<a href="https://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.22-linux-glibc2.12-x86_64.tar.gz）" target="_blank" rel="noopener">https://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.22-linux-glibc2.12-x86_64.tar.gz）</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf mysql-5.7.22-linux-glibc2.12-x86_64.tar.gz -C /data/twomysql</span><br><span class="line">cd /data/twomysql</span><br><span class="line">mv mysql-5.7.22-linux-glibc2.12-x86_64 twomysql</span><br></pre></td></tr></table></figure></p>
<p>创建相关数据、日志、配置文件目录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /data/twomysql/twomysql/log</span><br><span class="line">touch /data/twomysql/twomysql/log/mysqld.log</span><br><span class="line">chown -R mysql.mysql /data/twomysql/twomysql/log</span><br><span class="line">mkdir -p /data/twomysql/twomysql/data</span><br><span class="line">chown -R mysql.mysql /data/twomysql/twomysql/data</span><br><span class="line">mkdir -p /data/twomysql/twomysql/tmp</span><br><span class="line">chown -R mysql.mysql /data/twomysql/twomysql/tmp</span><br><span class="line">mkdir -p /data/twomysql/twomysql/etc</span><br><span class="line">chown -R mysql.mysql /data/twomysql/twomysql/etc</span><br><span class="line">cd /data/twomysql/twomysql/etc</span><br></pre></td></tr></table></figure></p>
<p>配置文件信息如下，端口设为3307，目录设置跟上面创建的目录匹配：<br>vim my.cnf<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line">[client]</span><br><span class="line">port    = 3307</span><br><span class="line">socket    = /data/twomysql/twomysql/tmp/mysql.sock</span><br><span class="line">[mysql]</span><br><span class="line">prompt=&quot;\u@db \R:\m:\s [\d]&gt; &quot;</span><br><span class="line">no-auto-rehash</span><br><span class="line">[mysqld]</span><br><span class="line">user    = mysql</span><br><span class="line">port    = 3307</span><br><span class="line">basedir    = /data/twomysql/twomysql</span><br><span class="line">datadir    = /data/twomysql/twomysql/data</span><br><span class="line">socket    = /data/twomysql/twomysql/tmp/mysql.sock</span><br><span class="line">pid-file = /data/twomysql/twomysql/tmp/mysql.pid</span><br><span class="line">character-set-server = utf8mb4</span><br><span class="line">skip_name_resolve = 1</span><br><span class="line">open_files_limit    = 65535</span><br><span class="line">back_log = 1024</span><br><span class="line">max_connections = 2000</span><br><span class="line">max_connect_errors = 100</span><br><span class="line">net_read_timeout = 30</span><br><span class="line">net_write_timeout = 60</span><br><span class="line">slave_net_timeout = 90</span><br><span class="line">table_open_cache = 1024</span><br><span class="line">table_definition_cache = 1024</span><br><span class="line">table_open_cache_instances = 64</span><br><span class="line">thread_stack = 512K</span><br><span class="line">external-locking = FALSE</span><br><span class="line">max_allowed_packet = 32M</span><br><span class="line">sort_buffer_size = 4M</span><br><span class="line">join_buffer_size = 4M</span><br><span class="line">thread_cache_size = 768</span><br><span class="line">query_cache_size = 0</span><br><span class="line">query_cache_type = 0</span><br><span class="line">interactive_timeout = 600</span><br><span class="line">wait_timeout = 600</span><br><span class="line">tmp_table_size = 32M</span><br><span class="line">max_heap_table_size = 32M</span><br><span class="line">slow_query_log = 1</span><br><span class="line">slow_query_log_file = /data/twomysql/twomysql/log/slow.log</span><br><span class="line">log-error = /data/twomysql/twomysql/log/error.log</span><br><span class="line">long_query_time = 0.1</span><br><span class="line">server-id = 3306101</span><br><span class="line">log-bin = /data/twomysql/twomysql/log/mysql-binlog</span><br><span class="line">sync_binlog = 1</span><br><span class="line">binlog_cache_size = 4M</span><br><span class="line">max_binlog_cache_size = 1G</span><br><span class="line">max_binlog_size = 1G</span><br><span class="line">expire_logs_days = 7</span><br><span class="line">gtid_mode = on</span><br><span class="line">enforce_gtid_consistency = 1</span><br><span class="line">log_slave_updates</span><br><span class="line">binlog_format = row</span><br><span class="line">relay_log_recovery = 1</span><br><span class="line">relay-log = relay-log</span><br><span class="line">relay-log-purge = 1</span><br><span class="line">key_buffer_size = 32M</span><br><span class="line">read_buffer_size = 8M</span><br><span class="line">read_rnd_buffer_size = 4M</span><br><span class="line">bulk_insert_buffer_size = 64M</span><br><span class="line">lock_wait_timeout = 60</span><br><span class="line">explicit_defaults_for_timestamp = 1</span><br><span class="line">innodb_thread_concurrency = 0</span><br><span class="line">innodb_sync_spin_loops = 100</span><br><span class="line">innodb_spin_wait_delay = 30</span><br><span class="line">transaction_isolation = REPEATABLE-READ</span><br><span class="line">innodb_buffer_pool_size = 2048M</span><br><span class="line">innodb_buffer_pool_instances = 8</span><br><span class="line">innodb_buffer_pool_load_at_startup = 1</span><br><span class="line">innodb_buffer_pool_dump_at_shutdown = 1</span><br><span class="line">innodb_data_file_path = ibdata1:1G:autoextend</span><br><span class="line">innodb_flush_log_at_trx_commit = 1</span><br><span class="line">innodb_log_buffer_size = 32M</span><br><span class="line">innodb_log_file_size = 1G</span><br><span class="line">innodb_log_files_in_group = 3</span><br><span class="line">innodb_max_undo_log_size = 4G</span><br><span class="line">innodb_io_capacity = 4000</span><br><span class="line">innodb_io_capacity_max = 8000</span><br><span class="line">innodb_flush_neighbors = 0</span><br><span class="line">innodb_write_io_threads = 8</span><br><span class="line">innodb_read_io_threads = 8</span><br><span class="line">innodb_purge_threads = 4</span><br><span class="line">innodb_page_cleaners = 4</span><br><span class="line">innodb_open_files = 65535</span><br><span class="line">innodb_max_dirty_pages_pct = 50</span><br><span class="line">innodb_flush_method = O_DIRECT</span><br><span class="line">innodb_lru_scan_depth = 4000</span><br><span class="line">innodb_checksum_algorithm = crc32</span><br><span class="line">innodb_lock_wait_timeout = 30</span><br><span class="line">innodb_rollback_on_timeout = 1</span><br><span class="line">innodb_print_all_deadlocks = 1</span><br><span class="line">innodb_file_per_table = 1</span><br><span class="line">innodb_online_alter_log_max_size = 4G</span><br><span class="line">internal_tmp_disk_storage_engine = InnoDB</span><br><span class="line">innodb_stats_on_metadata = 0</span><br><span class="line">innodb_status_file = 1</span><br><span class="line">innodb_status_output = 0</span><br><span class="line">innodb_status_output_locks = 0</span><br><span class="line">performance_schema = 1</span><br><span class="line">performance_schema_instrument = &apos;%=on&apos;</span><br><span class="line">lower_case_table_names = 1</span><br><span class="line">explicit_defaults_for_timestamp = off</span><br><span class="line">sql_mode = STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION</span><br><span class="line">[mysqldump]</span><br><span class="line">quick</span><br><span class="line">max_allowed_packet = 32M</span><br><span class="line">[mysql.server]</span><br><span class="line">basedir=/data/twomysql/twomysql</span><br></pre></td></tr></table></figure></p>
<h4 id="3、初始化数据库"><a href="#3、初始化数据库" class="headerlink" title="3、初始化数据库"></a>3、初始化数据库</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir /data/twomysql/twomysql/mysql-files</span><br><span class="line">sudo chown mysql:mysql /data/twomysql/twomysql/mysql-files</span><br><span class="line">sudo chmod 750 /data/twomysql/twomysql/mysql-files</span><br></pre></td></tr></table></figure>
<p>设置无密码登录，在后面在重新创建密码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/data/twomysql/twomysql/bin/mysqld  --defaults-file=/data/twomysql/twomysql/etc/my.cnf --initialize-insecure --user=mysql </span><br><span class="line">sudo /data/twomysql/twomysql/bin/mysql_ssl_rsa_setup</span><br></pre></td></tr></table></figure></p>
<h4 id="4、初始化完成之后，启动数据库："><a href="#4、初始化完成之后，启动数据库：" class="headerlink" title="4、初始化完成之后，启动数据库："></a>4、初始化完成之后，启动数据库：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/data/twomysql/twomysql/bin/mysqld_safe --defaults-file=/data/twomysql/twomysql/etc/my.cnf --socket=/data/twomysql/twomysql/tmp/mysql.sock --port=3307 &amp;</span><br></pre></td></tr></table></figure>
<p><img src="https://i.imgur.com/U6azYpM.png" alt=""><br><img src="https://i.imgur.com/hHEuSC0.png" alt=""></p>
<h4 id="5、修改用户密码"><a href="#5、修改用户密码" class="headerlink" title="5、修改用户密码"></a>5、修改用户密码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/data/twomysql/twomysql/bin/mysqladmin -u root -P 3307  -S /data/twomysql/twomysql/tmp/mysql.sock password 123456</span><br></pre></td></tr></table></figure>
<h4 id="6、登录mysql，需要输入密码："><a href="#6、登录mysql，需要输入密码：" class="headerlink" title="6、登录mysql，需要输入密码："></a>6、登录mysql，需要输入密码：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/data/twomysql/twomysql/bin/mysql --socket=/data/twomysql/twomysql/tmp/mysql.sock --port=3307 -p</span><br></pre></td></tr></table></figure>
      
    </div>
    
  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/mysql/">mysql</a>
    </span>
    

    </div>

    
  </div>
  
    
    <h3 class="article-read"><a href="/2018/10/25/一台服务器安装多个mysql数据库程序/"><span>点击阅读</span></a></h3>
    
  
</article>





  <article class="article-container ">

  
    
    <h3 class="article-title"><a href="/2018/10/24/hp交换机启用snmp，并添加到zabbix监控/"><span>[Zabbix] zabbix监控hp-switch</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2018/10/24/hp交换机启用snmp，并添加到zabbix监控/" rel="bookmark">
        <time class="entry-date published" datetime="2018-10-24T07:51:00.000Z">
          2018-10-24
        </time>
      </a>
    </span>
    <br />
    
  </div>


  

  <div class="article-content">
    <div class="entry">
      
          <h4 id="1、通过console口、telnet、ssh连接到switch的命令行，登录具有管理员权限的用户。使用system-view进入特权模式"><a href="#1、通过console口、telnet、ssh连接到switch的命令行，登录具有管理员权限的用户。使用system-view进入特权模式" class="headerlink" title="1、通过console口、telnet、ssh连接到switch的命令行，登录具有管理员权限的用户。使用system-view进入特权模式"></a>1、通过console口、telnet、ssh连接到switch的命令行，登录具有管理员权限的用户。使用system-view进入特权模式</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># system-view</span><br></pre></td></tr></table></figure>
<h4 id="2、配置snmp服务，设置版本、联系人信息、设备位置、团体名"><a href="#2、配置snmp服务，设置版本、联系人信息、设备位置、团体名" class="headerlink" title="2、配置snmp服务，设置版本、联系人信息、设备位置、团体名"></a>2、配置snmp服务，设置版本、联系人信息、设备位置、团体名</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># snmp-agent</span><br><span class="line"># snmp-agent sys-info version v2c</span><br><span class="line"># snmp-agent sys-info contact Zamasu &lt;zamasu@dbsuper.com&gt;</span><br><span class="line"># snmp-agent sys-info location Universe10 - IT Room</span><br><span class="line"># snmp-agent community read GokuBlack</span><br></pre></td></tr></table></figure>
<h4 id="3、保存配置信息："><a href="#3、保存配置信息：" class="headerlink" title="3、保存配置信息："></a>3、保存配置信息：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#save</span><br></pre></td></tr></table></figure>
<h4 id="4、保存完成之后hp交换机snmp服务已经配置完成，下面测试zabbix服务器和hp交换机之间的snmp团体名。在zabbix安装snmp测试snmp服务："><a href="#4、保存完成之后hp交换机snmp服务已经配置完成，下面测试zabbix服务器和hp交换机之间的snmp团体名。在zabbix安装snmp测试snmp服务：" class="headerlink" title="4、保存完成之后hp交换机snmp服务已经配置完成，下面测试zabbix服务器和hp交换机之间的snmp团体名。在zabbix安装snmp测试snmp服务："></a>4、保存完成之后hp交换机snmp服务已经配置完成，下面测试zabbix服务器和hp交换机之间的snmp团体名。在zabbix安装snmp测试snmp服务：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># yum install snmp(apt-get install snmp)</span><br><span class="line"># snmpwalk -v2c -c GokuBlack 192.168.0.200</span><br></pre></td></tr></table></figure>
<p>192.168.0.200为hp交换机的地址<br>下面为snmpwalk输出结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SNMPv2-MIB::sysDescr.0 = STRING: HPE V1910-48G Switch Software Version 5.20, Release 1519P03</span><br><span class="line">Copyright(c) 2010-2017 Hewlett Packard Enterprise Development, L.P.</span><br><span class="line">SNMPv2-MIB::sysObjectID.0 = OID: SNMPv2-SMI::enterprises.25506.11.1.85</span><br><span class="line">DISMAN-EVENT-MIB::sysUpTimeInstance = Timeticks: (197804302) 22 days, 21:27:23.02</span><br><span class="line">SNMPv2-MIB::sysContact.0 = STRING: Zamasu &lt;zamasu@dbsuper.com&gt;</span><br><span class="line">SNMPv2-MIB::sysName.0 = STRING: TECH-SW01</span><br><span class="line">SNMPv2-MIB::sysLocation.0 = STRING: Universe10 - IT Room</span><br></pre></td></tr></table></figure></p>
<h4 id="5、配置zabbix仪表板："><a href="#5、配置zabbix仪表板：" class="headerlink" title="5、配置zabbix仪表板："></a>5、配置zabbix仪表板：</h4><p>创建主机<br><img src="https://i.imgur.com/zOCoL44.png" alt=""><br><img src="https://i.imgur.com/wknK4aG.jpg" alt=""><br>下面配置snmp团体名用于zabbix连接hp交换机<br><img src="https://i.imgur.com/THDB2A8.jpg" alt=""><br>根据对应的交换机型号，去zabbix官网下载对应得模板：<br><a href="http://www.zabbix.org/wiki/Zabbix_Templates，点击[跳转](http://www.zabbix.org/wiki/Zabbix_Templates)" target="_blank" rel="noopener">http://www.zabbix.org/wiki/Zabbix_Templates，点击[跳转](http://www.zabbix.org/wiki/Zabbix_Templates)</a></p>

      
    </div>
    
  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/zabbix/">zabbix</a>
    </span>
    

    </div>

    
  </div>
  
    
    <h3 class="article-read"><a href="/2018/10/24/hp交换机启用snmp，并添加到zabbix监控/"><span>点击阅读</span></a></h3>
    
  
</article>





  <article class="article-container ">

  
    
    <h3 class="article-title"><a href="/2018/10/22/oracle 定期删除trace文件/"><span>[Oracle] oracle 定期删除trace文件</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2018/10/22/oracle 定期删除trace文件/" rel="bookmark">
        <time class="entry-date published" datetime="2018-10-22T11:05:00.000Z">
          2018-10-22
        </time>
      </a>
    </span>
    <br />
    
  </div>


  

  <div class="article-content">
    <div class="entry">
      
          <h4 id="oracle-定期删除trace文件"><a href="#oracle-定期删除trace文件" class="headerlink" title="oracle 定期删除trace文件"></a>oracle 定期删除trace文件</h4><p>cat del_trace.sh<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">#oracle 11gR2 rdbms</span><br><span class="line"></span><br><span class="line">#声明oracle环境变量</span><br><span class="line">export ORACLE_BASE=/u01/app/oracle</span><br><span class="line">export ORACLE_HOME=$ORACLE_BASE/product/11.2.0.4/dbhome_1</span><br><span class="line">#声明主机名</span><br><span class="line">export HOST_NAME=`hostname`</span><br><span class="line">#声明日期，用于删除几天前的文件</span><br><span class="line">export DAYS=7</span><br><span class="line"></span><br><span class="line">#一台服务器装有多个实例，可使用循环进行删除</span><br><span class="line">for dbname in instancea instanceb</span><br><span class="line">do</span><br><span class="line">export DB_NAME=$dbname</span><br><span class="line">export DB_UNIQUE_NAME=$&#123;DB_NAME&#125;</span><br><span class="line">export ORACLE_SID=$&#123;DB_NAME&#125;</span><br><span class="line">#当前实例为rac模式节点1，启用该变量</span><br><span class="line">#export ORACLE_SID=$&#123;DB_NAME&#125;1</span><br><span class="line">#当前实例为rac模式节点2，启用该变量</span><br><span class="line">#export ORACLE_SID=$&#123;DB_NAME&#125;2</span><br><span class="line"></span><br><span class="line">#指定存放日志的路径</span><br><span class="line">DIAGNOSTIC_DEST=$&#123;ORACLE_BASE&#125;</span><br><span class="line"></span><br><span class="line">#如果audit_trail_dest的一个默认值不生效，会使用下面第二个默认值：</span><br><span class="line">AUDIT_FILE_DEST=$&#123;ORACLE_BASE&#125;/admin/$&#123;DB_NAME&#125;/adump</span><br><span class="line"></span><br><span class="line">#删除audit_trail_dest第一个默认值下的审计日志，并删除7天前的日志</span><br><span class="line">find $&#123;ORACLE_HOME&#125;/rdbms/audit -name &quot;$&#123;ORACLE_SID&#125;_*.aud&quot; -mtime +$&#123;DAYS&#125; -exec rm -f &#123;&#125; \;</span><br><span class="line">#如果audit_trail_dest的一个默认值不生效，查找第二个默认值下的审计日志，并删除7天前的日志：</span><br><span class="line">find $&#123;AUDIT_FILE_DEST&#125; -name &quot;$&#123;ORACLE_SID&#125;_*.aud&quot; -mtime +$&#123;DAYS&#125; -exec rm -f &#123;&#125; \;</span><br><span class="line">#删除指定路径alert下的文件</span><br><span class="line">find $&#123;DIAGNOSTIC_DEST&#125;/diag/rdbms/$&#123;DB_UNIQUE_NAME&#125;/$&#123;ORACLE_SID&#125;/alert -name &quot;log_[0-9]*.xml&quot; -mtime +$&#123;DAYS&#125; -exec rm -f &#123;&#125; \;</span><br><span class="line">#删除指定路径trace下的文件</span><br><span class="line">find $&#123;DIAGNOSTIC_DEST&#125;/diag/rdbms/$&#123;DB_UNIQUE_NAME&#125;/$&#123;ORACLE_SID&#125;/trace -name &quot;$&#123;ORACLE_SID&#125;_*.tr[c|m]&quot; -mtime +$&#123;DAYS&#125; -exec rm -f &#123;&#125; \;</span><br><span class="line">find $&#123;DIAGNOSTIC_DEST&#125;/diag/rdbms/$&#123;DB_UNIQUE_NAME&#125;/$&#123;ORACLE_SID&#125;/trace -name &quot;cdmp_*&quot; -mtime +$&#123;DAYS&#125; -exec rm -rf &#123;&#125; \;</span><br><span class="line">done</span><br></pre></td></tr></table></figure></p>
<p>将该脚本，添加到cron下每日定期删除</p>

      
    </div>
    
  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/oracle/">oracle</a>
    </span>
    

    </div>

    
  </div>
  
    
    <h3 class="article-read"><a href="/2018/10/22/oracle 定期删除trace文件/"><span>点击阅读</span></a></h3>
    
  
</article>





  <article class="article-container ">

  
    
    <h3 class="article-title"><a href="/2018/10/22/oracle-audit_file_dest和audit_trail参数详解/"><span>[Oracle] oracle-audit_file_dest和audit_trail参数详解</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2018/10/22/oracle-audit_file_dest和audit_trail参数详解/" rel="bookmark">
        <time class="entry-date published" datetime="2018-10-22T08:22:00.000Z">
          2018-10-22
        </time>
      </a>
    </span>
    <br />
    
  </div>


  

  <div class="article-content">
    <div class="entry">
      
          <h4 id="1、AUDIT-FILE-DEST参数："><a href="#1、AUDIT-FILE-DEST参数：" class="headerlink" title="1、AUDIT_FILE_DEST参数："></a>1、AUDIT_FILE_DEST参数：</h4><p>当AUDIT_TRAIL初始化参数被设置为os, xml, or xml,extended，AUDIT_FILE_DEST指定操作系统目录，用于记录跟踪审计。<br>AUDIT_FILE_DEST的第一个默认值为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ORACLE_BASE/admin/ORACLE_SID/adump</span><br></pre></td></tr></table></figure></p>
<p>如果第一个值指定的目录不存在或者该值不可用，会启用第二个默认值：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ORACLE_HOME/rdbms/audit</span><br></pre></td></tr></table></figure></p>
<p>这两个默认值只适用于unix系统，其他平台系统默认值不同。<br>在多租户cdb模式下,默认值会被追加pdb的guid，用于存储属于pdb的审计记录。<br>例如，pdb的guid为03E1F908EE04252CE053B280E80AAAA3，第一个默认目录是:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ORACLE_BASE/admin/ORACLE_SID/adump/03E1F908EE04252CE053B280E80AAAA3</span><br></pre></td></tr></table></figure></p>
<p>关于pdb的guid可以通过V$CONTAINERS视图参看。</p>
<p>如果AUDIT_TRAIL参数设置为xml, or xml,extended，审计记录会以xml的格式存储。如果AUDIT_SYS_OPERATIONS参数启用，用于审计sys用户的记录，审计信息也会强制写入这个位置。<br>在多租户容器数据库，audit_file_dest的值设置范围是cdb。虽然审计记录是每个pdb提供的，但是每个pdb不能修改该初始化参数。</p>
<h4 id="2、audit-trail参数"><a href="#2、audit-trail参数" class="headerlink" title="2、audit_trail参数"></a>2、audit_trail参数</h4><p>value值详解：<br>none：禁用数据库审计<br>os：开启数据库审计，并将所有审计记录定向到操作系统的审计跟踪。<br>db：开启数据库审计，并将所有审计记录定向到数据库审计跟踪（sys.aud$)<br>db, extended:开启数据库审计，并将所有审计记录定向到数据库审计跟踪（sys.aud$),另外，sys.aud$表中类型为clob的两列（sqlbind和sqltext会被写入数据）<br>xml：开启数据库审计，并将所有审计记录以xml格式写入操作系统文件<br>xml,extended:开启数据库审计，并打印所有的审计记录列，包括SqlText和SqlBind字段</p>

      
    </div>
    
  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/oracle/">oracle</a>
    </span>
    

    </div>

    
  </div>
  
    
    <h3 class="article-read"><a href="/2018/10/22/oracle-audit_file_dest和audit_trail参数详解/"><span>点击阅读</span></a></h3>
    
  
</article>





  <article class="article-container ">

  
    
    <h3 class="article-title"><a href="/2018/10/18/linux区分当前服务器是物理机还是虚拟机/"><span>[Linux] linux区分当前服务器是物理机还是虚拟机方法</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2018/10/18/linux区分当前服务器是物理机还是虚拟机/" rel="bookmark">
        <time class="entry-date published" datetime="2018-10-18T10:35:00.000Z">
          2018-10-18
        </time>
      </a>
    </span>
    <br />
    
  </div>


  

  <div class="article-content">
    <div class="entry">
      
          <h3 id="1、查看系统产品名称："><a href="#1、查看系统产品名称：" class="headerlink" title="1、查看系统产品名称："></a>1、查看系统产品名称：</h3><p>dmidecode -s system-product-name<br>物理机：<br><img src="https://i.imgur.com/fV68YVX.png" alt=""><br>Azure微软云服务器<br><img src="https://i.imgur.com/zlsbp4u.png" alt=""><br>aws亚马逊云服务器<br><img src="https://i.imgur.com/5iOdIf3.png" alt=""><br>阿里云服务器<br><img src="https://i.imgur.com/AlWSFW0.png" alt=""><br>使用vmware建立的虚拟机<br><img src="https://i.imgur.com/TpzQH8s.png" alt=""><br>使用kvm建立的虚拟机<br><img src="https://i.imgur.com/Q7h1vEC.png" alt=""></p>
<h3 id="2、查看scsi供应商："><a href="#2、查看scsi供应商：" class="headerlink" title="2、查看scsi供应商："></a>2、查看scsi供应商：</h3><p>cat /proc/scsi/scsi|grep Vendor<br>物理机：<br><img src="https://i.imgur.com/3ID5hHz.png" alt=""><br>Azure微软云服务器<br><img src="https://i.imgur.com/A9HEqR5.png" alt=""><br>aws亚马逊云服务器（看不到任何信息）<br><img src="https://i.imgur.com/x2Eandx.png" alt=""><br>阿里云服务器<br><img src="https://i.imgur.com/5wt4HXK.png" alt=""><br>使用vmware建立的虚拟机<br><img src="https://i.imgur.com/X1v9alH.png" alt=""><br>使用kvm建立的虚拟机<br><img src="https://i.imgur.com/rFMO9XJ.png" alt=""></p>
<h3 id="3、查看内核缓冲信息："><a href="#3、查看内核缓冲信息：" class="headerlink" title="3、查看内核缓冲信息："></a>3、查看内核缓冲信息：</h3><p>dmesg | grep -i virtual<br>物理机：<br><img src="https://i.imgur.com/lfLe8yz.png" alt=""><br>Azure微软云服务器<br><img src="https://i.imgur.com/ZP2vlPq.png" alt=""><br>aws亚马逊云服务器<br><img src="https://i.imgur.com/CJijhJv.png" alt=""><br>阿里云服务器<br><img src="https://i.imgur.com/Wy7zTE3.png" alt=""><br>使用vmware建立的虚拟机<br><img src="https://i.imgur.com/8SEgcjn.png" alt=""><br>使用kvm建立的虚拟机<br><img src="https://i.imgur.com/7IacEIc.png" alt=""></p>

      
    </div>
    
  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/linux/">linux</a>
    </span>
    

    </div>

    
  </div>
  
    
    <h3 class="article-read"><a href="/2018/10/18/linux区分当前服务器是物理机还是虚拟机/"><span>点击阅读</span></a></h3>
    
  
</article>





  <article class="article-container ">

  
    
    <h3 class="article-title"><a href="/2018/10/18/mysql忘记root密码，修改密码方法/"><span>[Mysql] mysql忘记root密码，修改密码方法</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2018/10/18/mysql忘记root密码，修改密码方法/" rel="bookmark">
        <time class="entry-date published" datetime="2018-10-18T02:23:00.000Z">
          2018-10-18
        </time>
      </a>
    </span>
    <br />
    
  </div>


  

  <div class="article-content">
    <div class="entry">
      
          <h3 id="1、修改my-cnf文件，在-mysqld-下添加’skip-grant-tables’参数："><a href="#1、修改my-cnf文件，在-mysqld-下添加’skip-grant-tables’参数：" class="headerlink" title="1、修改my.cnf文件，在[mysqld]下添加’skip-grant-tables’参数："></a>1、修改my.cnf文件，在[mysqld]下添加’skip-grant-tables’参数：</h3><p>cat /usr/local/mysql/etc/my.cnf<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">!include /usr/local/mysql/etc/mysqld.cnf</span><br><span class="line">port            = 3306</span><br><span class="line">basedir         = /usr/local/mysql/</span><br><span class="line">socket          = /usr/local/mysql/tmp/mysql.sock</span><br><span class="line">pid-file        = /usr/local/mysql/var/mysql.pid</span><br><span class="line">datadir         = /usr/local/mysql/var/</span><br><span class="line">skip-grant-tables</span><br></pre></td></tr></table></figure></p>
<h3 id="2、重启mysql进程："><a href="#2、重启mysql进程：" class="headerlink" title="2、重启mysql进程："></a>2、重启mysql进程：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/mysql restart</span><br></pre></td></tr></table></figure>
<h3 id="3、进入mysql控制台，修改mysql密码："><a href="#3、进入mysql控制台，修改mysql密码：" class="headerlink" title="3、进入mysql控制台，修改mysql密码："></a>3、进入mysql控制台，修改mysql密码：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; USE mysql ; </span><br><span class="line">Database changed</span><br><span class="line">mysql&gt;  UPDATE user SET Password = password ( &apos;12345678&apos; ) WHERE User = &apos;root&apos; ; </span><br><span class="line">Query OK, 1 row affected (0.06 sec)</span><br><span class="line">Rows matched: 1  Changed: 1  Warnings: 0</span><br><span class="line">mysql&gt; flush privileges ; </span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line">mysql&gt; quit</span><br></pre></td></tr></table></figure>
<h3 id="4、注释掉my-cnf配置文件下的skip-grant-tables这行参数，重新启动mysql："><a href="#4、注释掉my-cnf配置文件下的skip-grant-tables这行参数，重新启动mysql：" class="headerlink" title="4、注释掉my.cnf配置文件下的skip-grant-tables这行参数，重新启动mysql："></a>4、注释掉my.cnf配置文件下的skip-grant-tables这行参数，重新启动mysql：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/mysql restart</span><br></pre></td></tr></table></figure>
<h3 id="5、测试密码是否修改成功-能否正常登陆控制台："><a href="#5、测试密码是否修改成功-能否正常登陆控制台：" class="headerlink" title="5、测试密码是否修改成功,能否正常登陆控制台："></a>5、测试密码是否修改成功,能否正常登陆控制台：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p12345678</span><br></pre></td></tr></table></figure>

      
    </div>
    
  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/mysql/">mysql</a>
    </span>
    

    </div>

    
  </div>
  
    
    <h3 class="article-read"><a href="/2018/10/18/mysql忘记root密码，修改密码方法/"><span>点击阅读</span></a></h3>
    
  
</article>






<nav class="pagination">
  
  <a href="/page/3/" class="pagination-prev">上一页</a>
  
  
  <a href="/page/5/" class="pagination-next">下一页</a>
  
</nav>
            </main>
            <div class="sidebar
                    col-lg-3 col-lg-offset-0
                    col-md-3 col-md-offset-0
                    col-sm-12
                    col-xs-12
                    sidebar-container
                ">

                <div class="sidebar-container">



<div class="search-container">
<form class="site-search-form">
    <span class="glyphicon glyphicon-search"></span><input type="text" id="local-search-input" class="st-search-input" placeholder="Search..." />
</form>
<div id="local-search-result" class="local-search-result-cls"></div>
</div>
<script type="text/javascript" id="local.search.active">
var inputArea       = document.querySelector("#local-search-input");
inputArea.onclick   = function(){ getSearchFile(); this.onclick = null }
inputArea.onkeydown = function(){ if(event.keyCode == 13) return false }
</script>




    <div class="categories-container" style="margin-top:40px;">
        <p>归档:</p>
            
    </div>




    <div class="social-container" style="margin-top:40px;">
        <p>Links:</p>
            
                
                    <li class="social-item"><i class="fa fa-fw fa-github"></i><a href="https://github.com/zeven0707">GitHub</a></li>
                
            
    </div>

</div>
            </div>
          </div>
        </div>
        
    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/BosenY/Lap" target="_blank">Lap</a>
    <br/><span id="busuanzi_container_site_uv"> 
  本站访客数<span id="busuanzi_value_site_uv"></span>人次
</span>
    </br>
    
      
        &copy; 2019 zeven0707&#39;s blog
      
    
  </p>
</footer>
    
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-92842840-1', 'auto');
    ga('send', 'pageview');

</script>


  </div>

</div>
<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script src="https://cdn.bootcss.com/vue/2.5.13/vue.min.js"></script>
<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

  <script src="https://unpkg.com/draw-something/dist/draw.min.js"></script>
  <script>
    let maxNum = Number.parseInt('30')
    let iconText = '❤'
    let color = 'red'
    new Draw({maxNum, iconText, color})
  </script>

<script src="/js/index.js"></script>
<script src="/js/search.js"></script>

</body>
</html>